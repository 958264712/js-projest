<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <meta name="renderer" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="applicable-device" content="pc" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <title>JS替换等操作</title>
  <style>
    /*全局*/
    html,
    body,
    div,
    span,
    applet,
    object,
    iframe,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    blockquote,
    pre,
    a,
    abbr,
    acronym,
    address,
    big,
    cite,
    code,
    del,
    dfn,
    em,
    img,
    ins,
    kbd,
    q,
    s,
    samp,
    small,
    strike,
    strong,
    sub,
    sup,
    tt,
    var,
    b,
    u,
    i,
    center,
    dl,
    dt,
    dd,
    ol,
    ul,
    li,
    fieldset,
    form,
    label,
    legend,
    table,
    caption,
    tbody,
    tfoot,
    thead,
    tr,
    th,
    td,
    article,
    aside,
    canvas,
    details,
    embed,
    figure,
    figcaption,
    footer,
    header,
    hgroup,
    menu,
    nav,
    output,
    ruby,
    section,
    summary,
    time,
    mark,
    audio,
    video {
      margin: 0;
      padding: 0;
      border: 0;
      font-size: 100%;
      color: #4f5157;
      list-style: none;
      text-decoration: none;
      text-align: -webkit-match-parent;
      vertical-align: baseline;
      -webkit-font-smoothing: antialiased;
      box-sizing: border-box;
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      -ms-box-sizing: border-box;
      -o-box-sizing: border-box;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    textarea::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.2);
      height: 50px;
      outline-offset: 0;
      outline: 1px solid rgba(255, 255, 255, 0.2);
      -webkit-border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0);
    }

    /*---鼠标在滚动条区域的滚动条显示样式--*/
    textarea::-webkit-scrollbar-thumb {
      background-color: #999;
      height: 50px;
      -webkit-border-radius: 8px;
      cursor: progress;
    }

    /*---滚动条大小--*/
    textarea::-webkit-scrollbar {
      width: 4px;
      height: 4px;
      -webkit-border-radius: 8px;
    }

    /*---滚动框背景样式--*/
    textarea::-webkit-scrollbar-track-piece {
      background-color: rgba(255, 255, 255, 0.1);
      -webkit-border-radius: 8px;
    }

    /*---x轴滚动条和y轴滚动条交汇的地方---*/
    textarea::-webkit-scrollbar-corner {
      background-color: transparent;
    }

    /*全局 定义flex*/
    .flex-use,
    .layout,
    .lay-edit,
    .lay-one ul,
    .lay-one ul li,
    .lay-m-tool ul,
    .lay-m-tool ul li,
    .lay-thr ul,
    .lay-thr ul li,
    .lay-four ul,
    .lay-four ul li,
    .lay-l ul,
    .btn-xl,
    .lay-m ul,
    .btn-gc,
    .lay-r ul,
    .btn-hb {
      display: -webkit-box;
      display: -moz-box;
      display: -ms-flexbox;
      display: -webkit-flex;
      display: flex;
    }

    /*全局 四向向居中*/
    .flex-ctr,
    .lay-m ul,
    .lay-r ul {
      -webkit-justify-content: center;
      justify-content: center;
      -moz-box-pack: center;
      -webkit-box-pack: center;
      box-pack: center;
      -webkit-align-items: center;
      align-items: center;
      -webkit-box-align: center;
      -moz-box-align: center;
      box-align: center;
    }

    /*全局 左上角*/
    .flex-lstr {
      -webkit-box-align: start;
      -moz-align-items: start;
      -webkit-align-items: start;
      align-items: start;
    }

    /*全局 左下角*/
    .flex-lend {
      -webkit-box-align: center;
      -moz-align-items: center;
      -webkit-align-items: center;
      align-items: center;
    }

    /*全局 左且上下居中*/
    .flex-lctr {
      -webkit-box-align: center;
      -moz-align-items: center;
      -webkit-align-items: center;
      align-items: center;
      -webkit-box-pack: start;
      -moz-justify-content: start;
      -webkit-justify-content: start;
      justify-content: start;
    }

    /*全局 右上角*/
    .flex-rend {
      -webkit-box-pack: end;
      -moz-justify-content: flex-end;
      -webkit-justify-content: flex-end;
      justify-content: flex-end;
    }

    /*全局 右且上下居中*/
    .flex-rctr,
    .lay-edit {
      -webkit-box-pack: end;
      -moz-justify-content: flex-end;
      -webkit-justify-content: flex-end;
      justify-content: flex-end;
      -webkit-box-align: center;
      -moz-align-items: center;
      -webkit-align-items: center;
      align-items: center;
    }

    /*全局 左右分散居中*/
    .flex-lrup,
    .lay-l ul,
    .lay-one ul li,
    .lay-m-tool ul,
    .lay-m-tool ul li,
    .lay-thr ul li,
    .lay-four ul li,
    .lay-edit {
      flex-direction: unset;
      -webkit-box-pack: justify;
      -moz-justify-content: space-between;
      -webkit-justify-content: space-between;
      justify-content: space-between;
      -webkit-box-align: center;
      -moz-align-items: center;
      -webkit-align-items: center;
      align-items: center;
    }

    /*全局 上下分散居中*/
    .flex-lrdw,
    .lay-one ul,
    .lay-thr ul,
    .lay-four ul,
    .btn-xl,
    .btn-gc,
    .btn-hb {
      flex-direction: column;
      -webkit-box-pack: justify;
      -moz-justify-content: space-between;
      -webkit-justify-content: space-between;
      justify-content: space-between;
      -webkit-box-align: center;
      -moz-align-items: center;
      -webkit-align-items: center;
      align-items: center;
    }

    /*全局 上下分散且居左*/
    .flex-lldw {
      flex-direction: column;
      -webkit-box-pack: start;
      -moz-justify-content: flex-start;
      -webkit-justify-content: flex-start;
      justify-content: flex-start;
      -webkit-box-align: start;
      -moz-align-items: initial;
      -webkit-align-items: initial;
      align-items: initial;
    }

    /*全局 左右分散且居左*/
    .flex-zyfsl {
      flex-direction: row;
      -webkit-box-pack: start;
      -moz-justify-content: flex-start;
      -webkit-justify-content: flex-start;
      justify-content: flex-start;
      -webkit-box-align: start;
      -moz-align-items: initial;
      -webkit-align-items: initial;
      align-items: initial;
    }

    .layout {
      margin: 4px;
      padding: 0;
    }

    .lay-one {
      width: 60px;
    }

    .lay-one ul li {
      width: 100%;
      height: auto;
      margin: 0 0 4px 0;
      border: 1px solid #bbb;
    }

    .lay-one ul li i {
      width: 12px;
      height: 28px;
      line-height: 28px;
      font-size: 12px;
      font-style: normal;
      text-align: center;
      background-color: #ccc;
    }

    .lay-one ul li label {
      flex: 1;
      width: 46px;
      height: 28px;
      line-height: 28px;
      font-size: 14px;
      text-align: center;
      cursor: pointer;
    }

    .lay-tow {
      width: 960px;
      margin: 0 4px;
    }

    .lay-thr {
      width: 60px;
    }

    .lay-four {
      width: 58px;
      height: 677px;
      overflow: auto;
      overflow-x: hidden;
    }

    .lay-four::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.2);
      height: 50px;
      outline-offset: 0;
      outline: 1px solid rgba(255, 255, 255, 0.2);
      -webkit-border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0);
    }

    /*---鼠标点击滚动条显示样式--*/
    .lay-four::-webkit-scrollbar-thumb {
      background-color: #999;
      height: 50px;
      -webkit-border-radius: 8px;
    }

    /*---滚动条大小--*/
    .lay-four::-webkit-scrollbar {
      width: 4px;
      height: 4px;
      -webkit-border-radius: 8px;
    }

    /*---滚动框背景样式--*/
    .lay-four::-webkit-scrollbar-track-piece {
      background-color: rgba(255, 255, 255, 0.1);
      -webkit-border-radius: 8px;
    }

    /*---x轴滚动条和y轴滚动条交汇的地方---*/
    .lay-four::-webkit-scrollbar-corner {
      background-color: transparent;
    }

    .lay-five {
      flex: 1;
      width: auto;
    }

    .lay-img {
      width: 100%;
      max-width: 960px;
      height: 336px;
      border: 1px solid #bbb;
      overflow: auto;
      overflow-x: hidden;
    }

    .lay-img img {
      width: 100%;
      max-width: 960px;
    }

    .lay-img::-webkit-scrollbar-thumb {
      background-color: rgba(255, 255, 255, 0.2);
      height: 50px;
      outline-offset: 0;
      outline: 1px solid rgba(255, 255, 255, 0.2);
      -webkit-border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0);
    }

    /*---鼠标点击滚动条显示样式--*/
    .lay-img::-webkit-scrollbar-thumb {
      background-color: #999;
      height: 50px;
      -webkit-border-radius: 8px;
    }

    /*---滚动条大小--*/
    .lay-img::-webkit-scrollbar {
      width: 4px;
      height: 4px;
      -webkit-border-radius: 8px;
    }

    /*---滚动框背景样式--*/
    .lay-img::-webkit-scrollbar-track-piece {
      background-color: rgba(255, 255, 255, 0.1);
      -webkit-border-radius: 8px;
    }

    /*---x轴滚动条和y轴滚动条交汇的地方---*/
    .lay-img::-webkit-scrollbar-corner {
      background-color: transparent;
    }

    .lay-m-tool {
      width: 100%;
      height: auto;
    }

    .lay-m-tool ul li {
      width: 62px;
      height: auto;
      margin: 4px 0;
      border: 1px solid #bbb;
    }

    .lay-m-tool ul li i {
      width: 12px;
      height: 28px;
      line-height: 28px;
      font-size: 12px;
      font-style: normal;
      text-align: center;
      background-color: #ccc;
    }

    .lay-m-tool ul li label {
      flex: 1;
      width: auto;
      height: 28px;
      line-height: 28px;
      font-size: 14px;
      text-align: center;
      cursor: pointer;
    }

    .lay-edit {
      width: 100%;
      max-width: 960px;
      height: 304px;
      overflow: hidden;
    }

    .lay-l {
      width: 100%;
      height: 304px;
      overflow: hidden;
    }

    .lay-l ul {
      height: 304px;
    }

    .text-xl {
      width: auto;
      height: auto;
    }

    .text-xl textarea {
      display: block;
      width: 386px;
      max-width: 712px;
      height: 296px;
      margin: 0 5px;
      line-height: 18px;
      letter-spacing: 2px;
      word-spacing: 3px;
      overflow: auto;
      padding: 0;
      box-sizing: border-box;
    }

    .btn-xl {
      width: 56px;
      height: 302px;
    }

    .btn-xl label {
      width: 56px;
      line-height: 23px;
      font-size: 14px;
      text-align: center;
      border-radius: 2px;
      border: 1px solid #aaa;
      background-color: #eee;
      cursor: pointer;
    }

    .lay-m {
      flex: 1;
      width: auto;
      height: 304px;
      overflow: hidden;
    }

    .text-gc {
      width: auto;
      height: auto;
    }

    .text-gc textarea {
      display: block;
      width: 386px;
      max-width: 712px;
      height: 296px;
      margin: 0 5px;
      line-height: 18px;
      overflow: auto;
      padding: 0;
      box-sizing: border-box;
    }

    .btn-gc {
      width: 56px;
      height: 302px;
    }

    .btn-gc label {
      width: 56px;
      line-height: 20px;
      font-size: 14px;
      text-align: center;
      border-radius: 3px;
      border: 1px solid #aaa;
      background-color: #eee;
      cursor: pointer;
    }

    .lay-r {
      height: 300px;
      overflow: hidden;
    }

    .text-hb {
      flex: 1;
      width: auto;
      height: auto;
    }

    .text-hb textarea {
      width: 100%;
      height: 300px;
      letter-spacing: 3px;
    }

    .btn-hb {
      width: 120px;
      height: 300px;
    }

    .btn-hb label {
      border: 1px solid #aaa;
      width: 100px;
      height: 32px;
      line-height: 32px;
      font-size: 14px;
      text-align: center;
      border-radius: 8px;
      cursor: pointer;
    }

    /****中间列按钮 S ****/
    .lay-thr ul li {
      width: 100%;
      height: auto;
      margin: 0 0 4px 0;
      border: 1px solid #bbb;
    }

    .lay-thr ul li i {
      width: 12px;
      height: 28px;
      line-height: 28px;
      font-size: 12px;
      font-style: normal;
      text-align: center;
      background-color: #ccc;
    }

    .lay-thr ul li label {
      flex: 1;
      width: 46px;
      height: 28px;
      line-height: 28px;
      font-size: 14px;
      text-align: center;
      cursor: pointer;
    }

    .lay-four ul {
      margin: 0 0 0 4px;
    }

    .lay-four ul li {
      width: 100%;
      height: auto;
      margin: 0 4px 3px 0;
      border: 1px solid #bbb;
    }

    .lay-four ul li label {
      flex: 1;
      width: 48px;
      height: 18px;
      line-height: 18px;
      font-size: 14px;
      text-align: left;
      cursor: pointer;
    }

    /****中间列按钮 E ****/

    /****最右侧（第四列）样式 S ****/
    .lay-five {
      flex: 1;
      width: auto;
      height: auto;
      overflow: hidden;
      margin: 0 0 0 4px;
      position: relative;
    }

    .lay-five textarea {
      width: 100%;
      height: 100%;
      line-height: 18px;
      overflow: auto;
      padding: 0;
      box-sizing: border-box;
    }

    /* 遮罩层 */
    .lay-five .mask {
      /* width: 100%;
        height: 100%; */
      max-width: 762px;
      max-height: 680px;
      position: absolute;
      top: 0px;
      z-index: 99;
      background-color: #4f5157;
      opacity: 0.7;
      display: none;
      padding-top: 20px;
      box-sizing: border-box;
    }

    .lay-five .mask p {
      color: #fff;
    }

    #close {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 32px;
      font-weight: 700;
      background-color: #4f5157;
      color: #000;
      cursor: pointer;
      border: none;
    }

    /****最右侧（第四列）样式 E ****/

    /****按键背景样式 S ****/
    .maohaofanfuzuo,
    .maohaofanfuyou,
    .zuoyoufanyou,
    .danfangzi,
    .duofangzi,
    .dasjihao,
    .zhunxinghao,
    .dshao,
    .dchao,
    .dszhunxinghao,
    .sangebafen,
    .sifenfudian,
    .gaoyin,
    .erbayinfu,
    .diyin,
    .qianbahoushiliu,
    .qianshiliuhouba,
    .erfenyinfu,
    .erfenfudian,
    .quanyinfu,
    .sifenyinfu,
    .bafenyinfu,
    .shiliufenyinfu,
    .daqiefen,
    .xiaoqiefen,
    .qiandafudian,
    .houdafudian,
    .qianxiaofudian,
    .houxiaofudian,
    .dasanlianyin,
    .xiaosanlianyin,
    .wulianyin,
    .liulianyin,
    .qilianyin,
    .qianyiyin,
    .shenghao,
    .jianghao,
    .huanyuanhao,
    .paineilianxian,
    .paineiduolianxian,
    .paijianlianxian,
    .jiejianlianxian,
    .diyindian,
    .gaoyindian,
    .banzhongzhi,
    .quanzhongzhi,
    .sjihao,
    .yuanshi,
    .dsyuanshi,
    .sierpai,
    .sisanpai,
    .sisipai,
    .basanpai,
    .baliupai,
    .ziyouyanchang,
    .huanqihao,
    .chanyinhao,
    .zhuandiaohao,
    .finejihao,
    .qieyin {
      background-image: url(static/images/yftips.png);
      background-repeat: repeat;
      background-size: 540%;
    }

    /****中间横排按钮****/
    .erbayinfu {
      background-position: 431px -75px;
    }

    .shiliufenyinfu {
      background-position: 426px -98px;
    }

    .qianbahoushiliu {
      background-position: 426px -945px;
    }

    .qianshiliuhouba {
      background-position: 427px -970px;
    }

    .xiaoqiefen {
      background-position: 426px -148px;
    }

    .daqiefen {
      background-position: 426px -126px;
    }

    .qianxiaofudian {
      background-position: 426px -223px;
    }

    .qiandafudian {
      background-position: 426px -174px;
    }

    .houxiaofudian {
      background-position: 427px -248px;
    }

    .houdafudian {
      background-position: 427px -198px;
    }

    .qianyiyin {
      background-position: 502px -475px;
      background-size: 640%;
    }

    .erfenyinfu {
      background-position: 427px -22px;
    }

    .erfenfudian {
      background-position: 427px -1244px;
    }

    .quanyinfu {
      background-position: 427px 2px;
    }

    .xiaosanlianyin {
      background-position: 411px -285px;
    }

    /****左侧竖排按钮****/
    .maohaofanfuzuo {
      background-position: 484px -56px;
      background-size: 640%;
    }

    .maohaofanfuyou {
      background-position: 480px -679px;
      background-size: 640%;
    }

    .zuoyoufanyou {
      background-position: 480px -707px;
      background-size: 640%;
    }

    .danfangzi {
      background-position: 452px -690px;
      background-size: 600%;
    }

    .duofangzi {
      background-position: 452px -715px;
      background-size: 600%;
    }

    .dasjihao {
      background-position: 480px -850px;
      background-size: 640%;
    }

    .zhunxinghao {
      background-position: 480px -877px;
      background-size: 640%;
    }

    .dshao {
      background-position: 481px -905px;
      background-size: 640%;
    }

    .dchao {
      background-position: 481px -1275px;
      background-size: 640%;
    }

    .dszhunxinghao {
      background-position: 540px -1051px;
      background-size: 720%;
    }

    .sangebafen {
      background-position: 409px -1216px;
    }

    .sifenfudian {
      background-position: 413px -1240px;
    }

    .banzhongzhi {
      background-position: 481px -792px;
      background-size: 640%;
    }

    .gaoyindian {
      background-position: 482px -962px;
      background-size: 640%;
    }

    .diyindian {
      background-position: 482px -992px;
      background-size: 640%;
    }

    .paineilianxian {
      background-position: 485px -509px;
      background-size: 640%;
    }

    .paijianlianxian {
      background-position: 480px -539px;
      background-size: 640%;
    }

    .jiejianlianxian {
      background-position: 481px -565px;
      background-size: 640%;
    }

    .paineiduolianxian {
      background-position: 480px -594px;
      background-size: 640%;
    }

    .shenghao {
      background-position: 480px -483px;
      background-size: 640%;
    }

    .jianghao {
      background-position: 479px -622px;
      background-size: 640%;
    }

    .huanyuanhao {
      background-position: 479px -652px;
      background-size: 640%;
    }

    .quanzhongzhi {
      background-position: 480px -821px;
      background-size: 640%;
    }

    /****右侧竖排按钮****/
    .dasanlianyin {
      background-position: 483px -311px;
      background-size: 640%;
    }

    .wulianyin {
      background-position: 468px -357px;
      background-size: 620%;
    }

    .liulianyin {
      background-position: 465px -385px;
      background-size: 620%;
    }

    .qilianyin {
      background-position: 465px -415px;
      background-size: 620%;
    }

    .sierpai {
      background-position: 466px -1096px;
      background-size: 620%;
    }

    .sisanpai {
      background-position: 466px -1123px;
      background-size: 620%;
    }

    .sisipai {
      background-position: 466px -1151px;
      background-size: 620%;
    }

    .basanpai {
      background-position: 466px -1179px;
      background-size: 620%;
    }

    .baliupai {
      background-position: 466px -1206px;
      background-size: 620%;
    }

    .ziyouyanchang {
      background-position: 481px -1302px;
      background-size: 640%;
    }

    .huanqihao {
      background-position: 481px -1330px;
      background-size: 640%;
    }

    .chanyinhao {
      background-position: 366px -1122px;
      background-size: 480%;
    }

    .zhuandiaohao {
      background-position: 480px -1358px;
      background-size: 640%;
    }

    .finejihao {
      background-position: 424px -1212px;
      background-size: 560%;
    }

    /****按键背景样式 E ., ., ., .zhuandiaohao, .,****/
  </style>
</head>

<body>
  <div class="layout">
    <div class="lay-one">
      <ul>
        <li>
          <!-- clickMask(true,弹窗id) -->
          <i title="这个标签触发提示弹层用的" onclick="clickMask(true,'maskone')">?</i><label title="这个标签用于按钮触发"
            class="maohaofanfuzuo" onclick="zhijiefuzhi(' |:')"></label>
        </li>
        <li>
          <i onclick="clickMask(true,'maskTwo')">?</i><label class="maohaofanfuyou" onclick="zhijiefuzhi(' :|')">
          </label>
        </li>
        <li>
          <i>?</i><label class="zuoyoufanyou" onclick="zhijiefuzhi(' :||:')">
          </label>
        </li>
        <li>
          <i>?</i><label class="danfangzi" onclick="zhuanhuanfuzhi(1,7)"> </label>
        </li>
        <li>
          <i>?</i><label class="duofangzi" onclick="zhuanhuanfuzhi(2,12)"> </label>
        </li>
        <li>
          <i>?</i><label class="dasjihao" onclick="zhijiefuzhi('!SEGNO!')"> </label>
        </li>
        <li>
          <i>?</i><label class="zhunxinghao" onclick="zhijiefuzhi('!CODA2!')">
          </label>
        </li>
        <li>
          <i>?</i><label class="dshao" onclick="zhijiefuzhi('!D.S.!')"> </label>
        </li>
        <li>
          <i>?</i><label class="dszhunxinghao" onclick="zhijiefuzhi('!CODA2!!D.S.!')">
          </label>
        </li>
        <li>
          <i>?</i><label class="dchao" onclick="zhijiefuzhi('!D.C.!')"> </label>
        </li>
        <!-- <li><i>?</i><label class="gaoyindian" onclick="specialCode(0,`'`,true)"> </label></li>
          <li><i>?</i><label class="diyindian" onclick="specialCode(0,`,`,true)"> </label></li> -->
        <li>
          <i>?</i><label class="sangebafen" onclick="specialCode(3,' / / /')">
          </label>
        </li>
        <li>
          <i>?</i><label class="sifenfudian" onclick="zhijiefuzhi('三/二 ')">
          </label>
        </li>
        <li>
          <i>?</i><label class="paineilianxian" onclick="specialCode(8,`-`)">
          </label>
        </li>
        <li>
          <i>?</i><label class="paijianlianxian" onclick="specialCode(12,` - `)">
          </label>
        </li>
        <li>
          <i>?</i><label class="jiejianlianxian" onclick="specialCode(9,` - |\n`)">
          </label>
        </li>
        <li>
          <i>?</i><label class="paineiduolianxian" onclick="specialCode(10,`()`)">
          </label>
        </li>
        <li>
          <i>?</i><label class="shenghao" onclick="zhijiefuzhi('^')"> </label>
        </li>
        <li>
          <i>?</i><label class="jianghao" onclick="zhijiefuzhi('_')"> </label>
        </li>
        <li>
          <i>?</i><label class="huanyuanhao" onclick="zhijiefuzhi('=')"> </label>
        </li>
        <li>
          <i>?</i><label class="quanzhongzhi" onclick="specialCode(11,`]`)"> </label>
        </li>
      </ul>
    </div>
    <div class="lay-tow">
      <div class="lay-img">
        <p>
          <img width="" height="" alt=""
            src="https://img.sutuihuo.com/uploads/allimg/33jinjipu/pay/big/pages/202303/1_3648_20230317192814324.png" />
        </p>
        <p>&nbsp;</p>
        <p>
          <img width="" height="" alt=""
            src="https://img.sutuihuo.com/uploads/allimg/33jinjipu/pay/big/pages/202303/2_3648_20230317192815672.png" />
        </p>
        <p>&nbsp;</p>
        <p>
          <img width="" height="" alt=""
            src="https://img.sutuihuo.com/uploads/allimg/33jinjipu/pay/big/pages/202303/3_3648_20230317192815812.png" />
        </p>
        <p>&nbsp;</p>
        <p>
          <img width="" height="" alt=""
            src="https://img.sutuihuo.com/uploads/allimg/33jinjipu/pay/big/pages/202303/4_3648_20230317192816467.png" />
        </p>
      </div>
      <div class="lay-m-tool">
        <ul>
          <li>
            <i title="这个标签触发提示弹层用的">?</i><label title="这个标签用于按钮触发" class="erbayinfu" onclick="specialCode(2,' / /',4)">
            </label>
          </li>
          <li>
            <i>?</i><label class="shiliufenyinfu" onclick="specialCode(4,` // // // //`,8)">
            </label>
          </li>
          <li>
            <i>?</i><label class="qianbahoushiliu" onclick="specialCode(3,' / // //',6)">
            </label>
          </li>
          <li>
            <i>?</i><label class="qianshiliuhouba" onclick="specialCode(3,' // // /',6)">
            </label>
          </li>
          <li>
            <i>?</i><label class="xiaoqiefen" onclick="specialCode(3,' // / //',6)">
            </label>
          </li>
          <li>
            <i>?</i><label class="daqiefen" onclick="specialCode(3,' /    /',5)">
            </label>
          </li>
          <li>
            <i>?</i><label class="qianxiaofudian" onclick="specialCode(2,' /> /',4)">
            </label>
          </li>
          <li>
            <i>?</i><label class="qiandafudian" onclick="specialCode(2,' >  ',4)">
            </label>
          </li>
          <li>
            <i>?</i><label class="houxiaofudian" onclick="specialCode(2,' /< /',4)">
            </label>
          </li>
          <li>
            <i>?</i><label class="houdafudian" onclick="specialCode(2,' <  ',4)">
            </label>
          </li>
          <li>
            <i>?</i><label class="qianyiyin" onclick="specialCode(1,'{//} ')">
            </label>
          </li>
          <li>
            <i>?</i><label class="erfenyinfu" onclick="specialCode(0,'二 ')">
            </label>
          </li>
          <li>
            <i>?</i><label class="erfenfudian" onclick="specialCode(0,'三 ')">
            </label>
          </li>
          <li>
            <i>?</i><label class="quanyinfu" onclick="specialCode(0,'四 ')"> </label>
          </li>
        </ul>
      </div>
      <div class="lay-edit">
        <div class="lay-l" id="lay-l">
          <ul>
            <li class="btn-xl">
              <label onclick="zhijiefuzhi(' ')">空格</label>
              <label onclick="handleItem('delete')">←删除</label>
              <label onclick="onGoBack()">撤销</label>
              <label onclick="handleFun(`'`)">引号'</label>
              <label onclick="handleFun(`''`)">引号''</label>
              <label onclick="handleFun(`,`)">逗号,</label>
              <label onclick="handleFun(`,,`)">逗号,,</label>
              <label onclick="oneSlash()">斜杠/</label>
              <label onclick="twoSlash()">斜杠//</label>
              <label onclick="zhijiefuzhi('(')">左括 (</label>
            </li>
            <li class="text-xl">
              <textarea id="content" style="min-width: 60px; resize: horizontal" spellcheck="false"></textarea>
            </li>
            <li class="btn-xl">
              <label onclick="getSelectText()">全选</label>
              <label onclick="changeItem(1)">转一行</label>
              <label onclick="changeItem(2)">转数字</label>
              <label onclick="handleItem('enter')">|+换行</label>
              <label onclick="handleItem('\n')">换单行</label>
              <label onclick="changeItem(3)">转字母</label>
              <label onclick="handleItemV2('V2')">音轨V2</label>
              <label onclick="handleItemV(4,'4V1')">4/4V1</label>
              <label onclick="handleItemV(2,'4V1')">2/4V1</label>
              <label onclick="returnBox()">框复位</label>
              <label onclick="zhijiefuzhi(')')">右括 )</label>
            </li>
            <li class="text-gc">
              <textarea id="content_right" style="min-width: 60px; resize: horizontal" spellcheck="false"></textarea>
            </li>
            <li class="btn-gc">
              <label onclick="changeRightItem(1)" title="注：转一行的同时将所有空格去掉，如果是英文歌词的情况下，要保留单词之间的空格">转一行</label>
              <!-- <label onclick="changeRightItem(2,'|')">竖线|</label>
              <label onclick="changeRightItem(2,'*')">占位*</label> -->
              <label onclick="zhijiefuzhi('|')">竖线|</label>
              <label onclick="zhijiefuzhi('*')">占位*</label>
              <label onclick="zhijiefuzhi(' ')">空格</label>
              <label onclick="handleItem('delete')">←删除</label>
              <label onclick="onGoBack()">撤销</label>
              <!-- <label onclick="changeRightItem(2,'-')">连字-</label>
              <label onclick="changeRightItem(2,'~')">二词音</label> -->
              <label onclick="zhijiefuzhi('-')">连字-</label>
              <label onclick="zhijiefuzhi('~')">二词音</label>
              <label onclick="changeRightItem(3)">排段落</label>
              <label onclick="changeRightItem(5,'W:\t')">无词W:</label>
              <label onclick="changeRightItem(5,'\n')">换行</label>
              <label onclick="changeRightItem(4,'W')">词前W:</label>
            </li>
          </ul>
        </div>
        <!-- <div class="lay-m" id="lay-m">
            <ul>
             
            </ul>
          </div> -->
      </div>
    </div>
    <div class="lay-thr">
      <ul>
        <li>
          <i title="这个标签触发提示弹层用的">?</i><label title="这个标签用于按钮触发" class="sierpai"
            onclick="zhijiefuzhi('[M: 2/4]')"></label>
        </li>
        <li>
          <i>?</i><label class="sisanpai" onclick="zhijiefuzhi('[M: 3/4]')"> </label>
        </li>
        <li>
          <i>?</i><label class="sisipai" onclick="zhijiefuzhi('[M: 4/4]')"> </label>
        </li>
        <li>
          <i>?</i><label class="basanpai" onclick="zhijiefuzhi('[M: 3/8]')"> </label>
        </li>
        <li>
          <i>?</i><label class="baliupai" onclick="zhijiefuzhi('[M: 6/8]')"> </label>
        </li>
        <li>
          <i>?</i><label class="ziyouyanchang" onclick="zhijiefuzhi('!HOLD!')">
          </label>
        </li>
        <li><i>?</i><label class="huanqihao"></label></li>
        <li>
          <i>?</i><label class="chanyinhao" onclick="zhijiefuzhi('')"> </label>
        </li>
        <li>
          <i>?</i><label class="zhuandiaohao" onclick="zhijiefuzhi('!转1=!')">
          </label>
        </li>
        <li>
          <i>?</i><label class="finejihao" onclick="zhijiefuzhi('!Fine.!')"> </label>
        </li>
        <li>
          <i>?</i><label class="xiaosanlianyin" onclick="specialCode(3,`(三`)"></label>
        </li>
        <li>
          <i>?</i><label class="dasanlianyin" onclick="specialCode(3,`(三    `)">
          </label>
        </li>
        <li>
          <i>?</i><label class="wulianyin" onclick="specialCode(5,`(五`)"> </label>
        </li>
        <li>
          <i>?</i><label class="liulianyin" onclick="specialCode(6,`(六`)"> </label>
        </li>
        <li>
          <i>?</i><label class="qilianyin" onclick="specialCode(7,`(七`)"> </label>
        </li>
        <li><i>?</i><label onclick="handleItemV(3,'4V1')">3/4V1</label></li>
        <li><i>?</i><label onclick="handleItemV(4,'4V1')">4/4V1</label></li>
        <li><i>?</i><label onclick="handleItemV(3,'8V1')">3/8V1</label></li>
        <li><i>?</i><label onclick="handleItemV(6,'8V1')">6/8V1</label></li>
        <li><i>?</i><label onclick="merge()">并音词</label></li>
      </ul>
    </div>
    <div class="lay-four">
      <ul>
        <li><label onclick="zhijiefuzhi(' ')">空格</label></li>
        <li><label onclick="handleItem('delete')">←删除</label></li>
        <li><label onclick="onGoBack()">撤销</label></li>
        <li><label onclick="addtext(1)">空线版</label></li>
        <li><label onclick="addtext(2)">免翻版</label></li>
        <li><label onclick="addtext(3)">翻页版</label></li>
        <li><label onclick="addtext(4 )">谱头</label></li>
        <li><label onclick="clickaddspecialCode(1,`I`)">选调i</label></li>
        <li><label onclick="clickaddspecialCode(1,`T`)">标题T</label></li>
        <li><label onclick="clickaddspecialCode(1,`C`)">信息C</label></li>
        <li><label onclick="clickaddspecialCode(1,`QMLK`)">QMLK</label></li>
        <li><label onclick="clickaddspecialCode(0,`V`)">V音轨</label></li>
        <li><label onclick="overSort(1)">完整序</label></li>
        <li><label onclick="overSort(0)">弱起序</label></li>
        <li><label onclick="zhijiefuzhi('C')">C</label></li>
        <li><label onclick="zhijiefuzhi('Cmaj7')">Cmaj7</label></li>
        <li><label onclick="zhijiefuzhi('D')">D</label></li>
        <li><label onclick="zhijiefuzhi('Dm')">Dm</label></li>
        <li><label onclick="zhijiefuzhi('Dm7')">Dm7</label></li>
        <li><label onclick="zhijiefuzhi('E')">E</label></li>
        <li><label onclick="zhijiefuzhi('Em')">Em</label></li>
        <li><label onclick="zhijiefuzhi('F')">F</label></li>
        <li><label onclick="zhijiefuzhi('Fmaj7')">Fmaj7</label></li>
        <li><label onclick="zhijiefuzhi('G')">G</label></li>
        <li><label onclick="zhijiefuzhi('A')">A</label></li>
        <li><label onclick="zhijiefuzhi('Am')">Am</label></li>
        <li><label onclick="zhijiefuzhi('Am7')">Am7</label></li>
        <li><label onclick="zhijiefuzhi('B')">B</label></li>
        <li><label onclick="zhijiefuzhi('Bm')">Bm</label></li>
        <li><label onclick="zhijiefuzhi('C7')">C7</label></li>
        <li><label onclick="zhijiefuzhi('Cadd9')">Cadd9</label></li>
        <li><label onclick="zhijiefuzhi('C#m')">#Cm</label></li>
        <li><label onclick="zhijiefuzhi('D7')">D7</label></li>
        <li><label onclick="zhijiefuzhi('D/#F')">D/#F</label></li>
        <li><label onclick="zhijiefuzhi('Eb')">bE</label></li>
        <li><label onclick="zhijiefuzhi('E7')">E7</label></li>
        <li><label onclick="zhijiefuzhi('Em7')">Em7</label></li>
        <li><label onclick="zhijiefuzhi('Fm')">Fm</label></li>
        <li><label onclick="zhijiefuzhi('F#')">#F</label></li>
        <li><label onclick="zhijiefuzhi('F#m')">#Fm</label></li>
        <li><label onclick="zhijiefuzhi('G7')">G7</label></li>
        <li><label onclick="zhijiefuzhi('Gm')">Gm</label></li>
        <li><label onclick="zhijiefuzhi('Ab')">bA</label></li>
        <li><label onclick="zhijiefuzhi('A7')">A7</label></li>
        <li><label onclick="zhijiefuzhi('Bb')">bB</label></li>
        <li><label onclick="zhijiefuzhi('B7')">B7</label></li>
        <li><label onclick="zhijiefuzhi('Bm7')">Bm7</label></li>
      </ul>
    </div>
    <div class="lay-five">
      <textarea id="content_five" spellcheck="false"></textarea>
      <!-- 弹窗div父节点 -->
      <div>
        <!-- 第一个弹窗弹窗div clickMask(fasle,弹窗的id)  class="mask"是公共样式不可缺-->
        <div id="maskone" class="mask">
          <p>第一个弹窗</p>
          <button id="close" onclick="clickMask(false,'maskone')">X</button>
        </div>
        <!-- 第一个弹窗弹窗div -->
        <div id="maskTwo" class="mask">
          <p>第二个弹窗</p>
          <button id="close" onclick="clickMask(false,'maskTwo')">X</button>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  var oContent = document.getElementById("content");
  var ContentValue = document.getElementById("content").value;
  var ContentFiveValue = document.getElementById("content_five").value;
  var fContent = document.getElementById("content_five");
  var ContentRightValue = document.getElementById("content_right").value;
  var rContent = document.getElementById("content_right");
  var str, strcopy, hisArr, start, end, ifAllOver;
  const MutationObserver =
    window.MutationObserver ||
    window.WebKitMutationObserver ||
    window.MozMutationObserver;
  oContent.onmouseleave = function () {
    str = window.getSelection().toString();
  };
  fContent.onmouseleave = function () {
    str = window.getSelection().toString();
  };
  rContent.onmouseleave = function () {
    str = window.getSelection().toString();
  };

  let backTextO = [];
  let backTextR = [];
  let backTextF = [];
  let backTextOEnd = [];
  let backTextREnd = [];
  let backTextFEnd = [];


  let IfFiveContent = false;
  let IfOContent = false;
  let IfRContent = false;
  var num = 0;
  oContent.addEventListener("input", function (e) {
    // 在这里编写处理change事件的代码
    ContentValue = e.target.value;
    backText = e.target.value;
  });
  fContent.addEventListener("input", function (e) {
    // 在这里编写处理change事件的代码
    ContentFiveValue = e.target.value;
  });
  rContent.addEventListener("input", function (e) {
    // 在这里编写处理change事件的代码
    ContentRightValue = e.target.value;
  });
  oContent.addEventListener("click", function (e) {
    IfFiveContent = false;
    IfRContent = false;
    IfOContent = true;
    ContentValue = e.target.value;
  });
  rContent.addEventListener("click", function (e) {
    IfOContent = false;
    IfFiveContent = false;
    IfRContent = true;
    ContentRightValue = e.target.value;
  });
  fContent.addEventListener("click", function (e) {
    IfFiveContent = true;
    IfRContent = false;
    IfOContent = false;
    ContentFiveValue = e.target.value;
  });

  const handleFun = (type) => {
    if (IfOContent) {
      hisArr = ContentValue.split("");
      start = oContent.selectionStart;
      sr = document.getElementById("content");
      end = oContent.selectionEnd;
    } else {
      hisArr = ContentFiveValue.split("");
      start = fContent.selectionStart;
      sr = document.getElementById("content_five");
      end = fContent.selectionEnd;
    }
    if (str || ifAllOver || end) {
      // 处理内容
      let num1 = 0;
      let num2 = 0;
      let reg = /[/<>{}0-9]/;
      let reg1 = /[A-G1-9]/;
      let reg3 = /[\u4e00-\u9fa50-9A-Za-z，。.!?？！、\-\·{}"“:;：；*~【】\[\]\n\t%$#@^&()=+_（）|—]/;

      // 获取下标
      if (ifAllOver) {
        start = 0;
      }
      let newarr = hisArr.map((item, index) => {
        if (index >= start && index < end) {
          console.log(item, type);
          if ((item === "," || item === "'") && !str.length) {
            item = "";
          }
          if ((item === "," || item === "'") && str.length) {
            if (index === start) {
              num2++
              item = type;
            } else {
              num2--
              item = "";
            }
            if (item === ' ') {
              num2++
              return item
            }
            if (type === ',,' || type === "''") {
              num = end + num2 + 1 + type.length
              setSelectionRange(sr, end + num2 + 1 + type.length, end + 1 + num2 + type.length);
            } else {
              num = end + num2 + type.length
              setSelectionRange(sr, end + num2 + type.length, end + num2 + type.length);
            }
          }
          if (reg1.test(item)) {
            num2++
            num1 += type.length;
            return item + type;
          }
        }
        return item;
      });
      if (end && !str.length) {
        // 非选中状态，判断前一个是否为一种符号
        start = 0;
        if (newarr[end - 1] === "," && newarr[end - 1] !== type && type !== ",,"
        ) {
          newarr = [];
          // 判断end前有多少个不同的符号
          // console.log(newarr);
          for (let i = hisArr.length - 1; i >= 0; i--) {
            // console.log(hisArr[i]);
            if (i > end) {
              newarr.unshift(hisArr[i]);
            } else {
              // 判断符号起始和结束点

              if (
                hisArr[i] === "," &&
                reg1.test(hisArr[i - 1]) &&
                start <= i
              ) {
                num1 = 0;
                end = i;
                start = i - 1; //4
                newarr.unshift(type);
              } else if (
                (hisArr[i] === "," || hisArr[i] === "'") &&
                start > i
              ) {
                newarr.unshift(hisArr[i]);
              } else if (
                reg1.test(hisArr[i]) ||
                reg.test(hisArr[i]) ||
                hisArr[i] === " "
              ) {
                newarr.unshift(hisArr[i]);
              } else if (hisArr[i] === 'Z' || hisArr[i] === 0 || (!IfOContent && reg3.test(hisArr[i]))) {
                newarr.unshift(hisArr[i])
              }

            }
          }
          // console.log(newarr);
        } else if (
          newarr[end - 1] === "'" &&
          newarr[end - 1] !== type &&
          type !== "''"
        ) {
          newarr = [];
          // 判断end前有多少个不同的符号
          for (let i = hisArr.length - 1; i >= 0; i--) {
            if (i > end) {
              newarr.unshift(hisArr[i]);
            } else {
              if (
                hisArr[i] === "'" &&
                reg1.test(hisArr[i - 1]) &&
                start <= i
              ) {
                num1 = 0;
                end = i;
                start = i - 1;
                newarr.unshift(type);
              } else if (
                (hisArr[i] === "," || hisArr[i] === "'") &&
                start > i
              ) {
                newarr.unshift(hisArr[i]);
              } else if (
                reg1.test(hisArr[i]) ||
                reg.test(hisArr[i]) ||
                hisArr[i] === " "
              ) {
                newarr.unshift(hisArr[i]);
              } else if (hisArr[i] === 'Z' || hisArr[i] === 0 || (!IfOContent && reg3.test(hisArr[i]))) {
                newarr.unshift(hisArr[i])
              }
            }
          }
        } else {
          newarr.splice(end, 0, type);
        }
        if (type.length === 1) {
          num1++;
        } else {
          num1 += type.length;
        }
        num = end + num1
        setSelectionRange(sr, end + num1, end + num1);
      }
      if (IfOContent) {
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
      } else {
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }
      ifAllOver = false;
      str = "";
    }
  };

  //单斜杠
  function oneSlash() {
    if (IfOContent) {
      hisArr = ContentValue.split("");
      start = oContent.selectionStart;
      sr = document.getElementById("content");
      end = oContent.selectionEnd;
    } else {
      hisArr = ContentFiveValue.split("");
      start = fContent.selectionStart;
      sr = document.getElementById("content_five");
      end = fContent.selectionEnd;
    }
    let reg1 = /[A-GZ0-9]/;
    let newarr;
    let ifjudgu;
    let judgulist = []
    if (ifAllOver) {
      start = 0;
    }
    if (str || ifAllOver || end) {
      if (end && !str.length) {
        newarr = hisArr;
        newarr.splice(end, 0, "/");
        num = end + 1
        setSelectionRange(sr, end + 1, end + 1);
      } else {
        if (!str.includes(",") && !str.includes("'")) {
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              judgulist.push(reg1.test(item));
              if (reg1.test(item) && item != " " && item != "/") {
                return item + "/";
              } else if (item === "/") {
                return "";
              }
            }
            return item;
          });
          ifjudgu = judgulist.every((item) => item === true)
          if (!ifjudgu) {
            newarr.splice(start, 0, "/")
            num = start + 1
            setSelectionRange(sr, start + 1, start + 1)
          }
        } else {
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (reg1.test(item)) {
                return item;
              } else if (item === "," && hisArr[index + 1] === ",") {
                return ",,/";
              } else if (item === "'" && hisArr[index + 1] === "'") {
                return "''/";
              } else if (hisArr[index - 1] === "'" && item === "'") {
                return "";
              } else if (hisArr[index - 1] === "," && item === ",") {
                return "";
              } else if (
                hisArr[index - 1] === "," &&
                hisArr[index + 1] !== "/" &&
                item === ","
              ) {
                return "";
              } else if (
                item === "," &&
                hisArr[index + 1] !== "," &&
                hisArr[index + 1] !== "/"
              ) {
                return ",/";
              } else if (
                item === "'" &&
                hisArr[index + 1] !== "'" &&
                hisArr[index + 1] !== "/"
              ) {
                return "'/";
              } else if (
                hisArr[index - 1] === "'" &&
                hisArr[index - 2] === "'" &&
                item === "/"
              ) {
                return "";
              } else if (
                hisArr[index - 1] === "," &&
                hisArr[index - 2] === "," &&
                item === "/"
              ) {
                return "";
              } else if (hisArr[index - 1] === "/" && item === "/") {
                return "";
              } else if (item === "/" && hisArr[index + 1] === "/") {
                return "/";
              } else if (item === "0" && hisArr[index + 1] === "/") {
                return "0";
              } else if (item === "0") {
                return item + "/";
              }
            }
            return item;
          });
        }
      }

      if (IfOContent) {
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
      } else {
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }
      ifAllOver = false;
      str = "";
    }
  }

  function twoSlash() {
    if (IfOContent) {
      hisArr = ContentValue.split("");
      start = oContent.selectionStart;
      sr = document.getElementById("content");
      end = oContent.selectionEnd;
    } else {
      hisArr = ContentFiveValue.split("");
      start = fContent.selectionStart;
      sr = document.getElementById("content_five");
      end = fContent.selectionEnd;
    }
    let newarr;
    let reg1 = /[A-GZ0-9]/;
    let ifjudgu;
    let judgulist = []
    // 获取下标
    if (ifAllOver) {
      start = 0;
    }
    if (str || ifAllOver || end) {
      if (end && !str.length) {
        newarr = hisArr;
        newarr.splice(end, 0, "//");
        num = end + 2
        setSelectionRange(sr, end + 2, end + 2);
      } else {
        if (!str.includes(",") && !str.includes("'")) {
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              judgulist.push(reg1.test(item));
              if (reg1.test(item) && item != " " && item != "/") {
                return item + "//";
              } else if (item === "/") {
                return "";
              }
            }
            return item;
          });
          ifjudgu = judgulist.every((item) => item === true)
          if (!ifjudgu) {
            newarr.splice(start, 0, "//")
            num = start + 2
            setSelectionRange(sr, start + 2, start + 2)
          }
        } else {
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (reg1.test(item) && item != "") {
                return item;
              } else if (item === "'" && hisArr[index + 1] === "'") {
                return "''//";
              } else if (hisArr[index - 1] === "'" && item === "'") {
                return "";
              } else if (
                hisArr[index - 1] === "'" &&
                hisArr[index - 2] === "'" &&
                item === "/"
              ) {
                return "";
              } else if (
                hisArr[index - 1] === "'" &&
                item === "/" &&
                hisArr[index - 2] !== "'"
              ) {
                return "//";
              } else if (hisArr[index - 1] === "," && item === ",") {
                return "";
              } else if (item === "," && hisArr[index + 1] === ",") {
                return ",,//";
              } else if (
                item === "/" &&
                hisArr[index - 1] === "," &&
                hisArr[index - 2] === ","
              ) {
                return "";
              } else if (hisArr[index - 1] === "," && item === ",") {
                return "";
              } else if (
                item === "," &&
                hisArr[index + 1] !== "," &&
                hisArr[index + 1] !== "/"
              ) {
                return ",//";
              } else if (item === "/" && hisArr[index - 1] === ",") {
                return "//";
              } else if (hisArr[index - 1] === "/" && item === "/") {
                return "";
              } else if (item === "/" && hisArr[index + 1] === "/") {
                return "";
              } else if (
                item === "0" &&
                (hisArr[index + 1] === "/") & (hisArr[index + 2] === "/")
              ) {
                return "0//";
              } else if (
                item === "0" &&
                (hisArr[index + 1] === "/") & (hisArr[index + 2] !== "/")
              ) {
                return "0/";
              } else if (item === "0") {
                return item + "//";
              }
            }
            return item;
          });
        }
      }

      if (IfOContent) {
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
      } else {
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }
      ifAllOver = false;
      str = "";
    }
  }

  // 撤销
  const onGoBack = () => {
    if (IfOContent) {
      if (backTextO.length) {
        oContent.value = backTextO[backTextO.length - 1];
        ContentValue = backTextO[backTextO.length - 1];
        backTextO.pop()
        backTextOEnd.pop()
        setSelectionRange(oContent, backTextOEnd[backTextOEnd.length - 1], backTextOEnd[backTextOEnd.length - 1])
      } else {
        oContent.value = ''
        ContentValue = ''
        setSelectionRange(oContent, 0, 0)
      }
    } else if (IfRContent) {
      if (backTextR.length) {
        rContent.value = backTextR[backTextR.length - 1];
        ContentRightValue = backTextR[backTextR.length - 1];
        backTextR.pop()
        backTextREnd.pop()
        setSelectionRange(rContent, backTextREnd[backTextREnd.length - 1], backTextREnd[backTextREnd.length - 1])
      } else {
        rContent.value = ''
        ContentRightValue = ''
        setSelectionRange(rContent, 0, 0)
      }
    } else {
      if (backTextF.length) {
        fContent.value = backTextF[backTextF.length - 1];
        ContentFiveValue = backTextF[backTextF.length - 1];
        backTextF.pop()
        backTextFEnd.pop()
        setSelectionRange(fContent, backTextFEnd[backTextFEnd.length - 1], backTextFEnd[backTextFEnd.length - 1])
      } else {
        fContent.value = ''
        ContentFiveValue = ''
        setSelectionRange(fContent, 0, 0)
      }
    }

  };

  // 全选
  const getSelectText = () => {
    if (window.getSelection) {
      let i = "";

      if (IfOContent) {
        if (
          oContent.selectionStart != undefined &&
          oContent.selectionEnd != undefined
        ) {
          i = oContent.value;
          ifAllOver = true;
        } else {
          i = "";
        }
        ContentValue = i;
        oContent.value = ContentValue;
      } else if (IfRContent) {
        if (
          rContent.selectionStart != undefined &&
          rContent.selectionEnd != undefined
        ) {
          i = rContent.value;
          ifAllOver = true;
        } else {
          i = "";
        }
        ContentRightValue = i;
        rContent.value = ContentRightValue;
      } else if (IfFiveContent) {
        if (
          fContent.selectionStart != undefined &&
          fContent.selectionEnd != undefined
        ) {
          i = fContent.value;
          ifAllOver = true;
        } else {
          i = "";
        }
        ContentFiveValue = i;
        fContent.value = ContentFiveValue;
      }

      if (num % 2 === 0) {
        if (IfOContent) {
          backText = ContentValue;
        } else if (IfRContent) {
          backTextRight = ContentRightValue;
        } else if (IfFiveContent) {

        }
      } else {
        backTextTwo = ContentValue;
      }


      str = "";
      setCss();
    } else {
      return document.selection.createRange().text;
    }
  };
  const setCss = () => {
    if (IfOContent) {
      setSelectionRange(oContent, 0, oContent.value.length);
    } else if (IfRContent) {
      setSelectionRange(rContent, 0, rContent.value.length);
    } else if (IfFiveContent) {
      setSelectionRange(fContent, 0, fContent.value.length);
    }
    //将光标定位到文本最后
  };
  const setSelectionRange = (input, selectionStart, selectionEnd) => {
    if (input.setSelectionRange) {
      input.focus();
      setTimeout(function () {
        input.setSelectionRange(selectionStart, selectionEnd);
      }, 10);
    } else if (input.createTextRange) {
      var range = input.createTextRange();
      range.collapse(true);
      range.moveEnd("character", selectionEnd);
      range.moveStart("character", selectionStart);
      range.select();
    }
  };
  // 转变函数
  const changeItem = (
    type,
    start = oContent.selectionStart,
    end = oContent.selectionEnd
  ) => {
    if (str || ifAllOver) {
      // 处理内容
      hisArr = ContentValue.split("");
      let newarr;
      let reg;
      // 获取下标
      if (ifAllOver) {
        start = 0;
      }
      switch (type) {
        case 1:
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (item === "\n") {
                item = "";
              }
            }
            return item;
          });
          break;
        case 2:
          reg = /[0-9IiLl|!！。oOD]/;
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (reg.test(item) !== true) {
                item = "";
              } else {
                if (
                  item === "I" ||
                  item === "i" ||
                  item === "L" ||
                  item === "l" ||
                  item === "|" ||
                  item === "!" ||
                  item === "！"
                ) {
                  return 1;
                } else if (
                  item === "。" ||
                  item === "o" ||
                  item === "O" ||
                  item === "D"
                ) {
                  return 0;
                } else {
                  return item;
                }
              }
            }
            return item;
          });
          break;
        case 3:
          reg = /[0-7一二三四五六七零]/;
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (item === " " && hisArr[index + 1] === " ") {
                return "";
              }
              if (reg.test(item) !== true) {
                return item;
              } else if (
                item >= 0 &&
                ((hisArr[index-1] === "|" && hisArr[index-2]===":")||(hisArr[index + 1] === "=" && hisArr[index + 2] === "!") ||
                  (hisArr[index - 1] === "|" &&
                    (hisArr[index - 2] === "!" ||
                      hisArr[index - 2] === '"')) ||
                  (hisArr[index + 1] === "]" &&
                    (hisArr[index - 1] === "/" ||
                      (hisArr[index - 3] === "V" &&
                        hisArr[index - 4] === "["))) ||
                  hisArr[index + 1] === "." ||
                  hisArr[index - 1] === "“" ||
                  (hisArr[index - 1] === " " &&
                    hisArr[index - 2] === ":" &&
                    hisArr[index - 3] === "M")) 
                  
              ) {
                return item;
              } else {
                return changeEng(item);
              }
            }
            return item;
          });
          break;
      }

      let sortNewarr = newarr.length - 1;
      // 删除末尾多余空格以及换行
      for (let i = newarr.length - 1; i >= 0; i--) {
        if (
          (newarr[newarr.length - 1] === "\n" ||
            newarr[newarr.length - 1] === " " ||
            newarr[newarr.length - 1] === "") &&
          (newarr[i] === "\n" || newarr[i] === " " || newarr[i] === "") &&
          i === sortNewarr
        ) {
          sortNewarr--;
          newarr.pop();
        }
      }
      backTextO.push(ContentValue)
      backTextOEnd.push(end)
      ContentValue = newarr.join("");
      oContent.value = ContentValue;
      ifAllOver = false;
      str = "";
    }
  };

  // 转字母
  const changeEng = (item) => {
    switch (item) {
      case "1":
        return "C";
        break;
      case "2":
        return "D";
        break;
      case "3":
        return "E";
        break;
      case "4":
        return "F";
        break;
      case "5":
        return "G";
        break;
      case "6":
        return "A";
        break;
      case "7":
        return "B";
        break;
      case "0":
        return "Z";
        break;
      case "一":
        return 1;
        break;
      case "二":
        return 2;
        break;
      case "三":
        return 3;
        break;
      case "四":
        return 4;
        break;
      case "五":
        return 5;
        break;
      case "六":
        return 6;
        break;
      case "七":
        return 7;
        break;
      case "零":
        return 0;
        break;
    }
  };

  // 操作函数
  const handleItem = (type) => {
    if (IfOContent) {
      hisArr = ContentValue.split("");
      sr = document.getElementById("content");
      start = oContent.selectionStart;
      end = oContent.selectionEnd;
    } else if (IfRContent) {
      hisArr = ContentRightValue.split("");
      sr = document.getElementById("content_right");
      start = rContent.selectionStart;
      end = rContent.selectionEnd;
    } else {
      hisArr = ContentFiveValue.split("");
      sr = document.getElementById("content_five");
      start = fContent.selectionStart;
      end = fContent.selectionEnd;
    }
    if (str || ifAllOver || end || (end === 0 && type === "\n")) {
      // 处理内容
      let newarr;
      // 获取下标
      if (ifAllOver) {
        start = 0;
      }
      switch (type) {
        case "\n":
          newarr = hisArr;
          if ((end === 0 || end === newarr, length - 1)) {
            newarr.splice(end, 0, "\n");
            newarr.splice(end + 1, 0, "\n");
          } else {
            newarr.splice(end, 0, "\n");
          }
          num = end + 1
          setSelectionRange(oContent, end + 1, end + 1);
          break;
        case "enter":
          let ifEnter = false;
          newarr = hisArr.map((item, index) => {
            if (index === end || index + 1 === end) {
              ifEnter = true;
            }
            return item;
          });
          if (str.length) {
            newarr.splice(start, end - start, " |\n\n");
          } else {
            if (ifEnter) {
              newarr.splice(end, 0, ` `);
              newarr.splice(end + 1, 0, `|`);
              newarr.splice(end + 2, 0, `\n`);
              newarr.splice(end + 3, 0, `\n`);
              ifEnter = false;
            }
          }
          let enNum = 0;
          let ifAf = false;
          newarr = newarr.map((item, index) => {
            if (
              end === index &&
              newarr[end - 1] !== " " &&
              newarr[end] === " "
            ) {
              ifAf = true;
            }
            if (item === " " && newarr[index + 1] === " ") {
              enNum++;
              return "";
            }
            if (ifAf) {
              if (item === " " && newarr[index - 1] === " ") {
                enNum++;
                return "";
              }
            }
            return item;
          });
          if (ifAf) {
            enNum = 0;
          }
          num = end + 3 - enNum
          setSelectionRange(oContent, end + 3 - enNum, end + 3 - enNum);
          if(newarr[end+4] === ' '){
            newarr.splice(end+4,1)
          }
          break;
        case "delete":
          let ifDelete = false;
          newarr = hisArr.map((item, index) => {
            if (index === end || index + 1 === hisArr.length) {
              ifDelete = true;
            }
            return item;
          });
          if (str.length) {
            newarr.splice(start, end - start);
            num = end - str.length
            setSelectionRange(sr, end - str.length, end - str.length);
            ifDelete = false;
          } else {
            if (ifDelete) {
              newarr.splice(end - 1, 1);
              if (IfOContent) {
                setSelectionRange(oContent, end - 1, end - 1);
              } else if (IfRContent) {
                setSelectionRange(rContent, end - 1, end - 1);
              } else if (IfFiveContent) {
                setSelectionRange(fContent, end - 1, end - 1);
              }
              num = end - 1
              ifDelete = false;
            }
          }
          break;
      }
      newarr.map((item, index) => {
        if (
          newarr[newarr.length - 1] === "\n" &&
          index === newarr.length - 1 &&
          item === "\n"
        ) {
          newarr.pop();
        }
      });
      if (IfOContent) {
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
      } else if (IfRContent && type === "delete") {
        ContentRightValue = newarr.join("");
        rContent.value = ContentRightValue;
        backTextR.push(ContentRightValue)
        backTextREnd.push(num)
      } else if (IfFiveContent && type === "delete") {
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
      }
      ifAllOver = false;
      str = "";
    }
  };
  //  V2
  const handleItemV2 = (
    type,
    start = oContent.selectionStart,
    end = oContent.selectionEnd
  ) => {
    if (str || ifAllOver) {
      // 处理内容
      hisArr = ContentValue.split("");
      let newarr;
      // 获取下标
      if (ifAllOver) {
        start = 0;
      }
      switch (type) {
        case "V2":
          let itemList = [];
          newarr = hisArr.map((item, index) => {
            if (item === "\n" && hisArr[index + 1] === "\n") {
              itemList.push(index + 1);
            }
            if (item === " " && hisArr[index + 1] === " ") {
              return "";
            }
            return item;
          });
          newarr.splice(0, 0, "\n");
          newarr.splice(1, 0, "[V: 2]");
          newarr.splice(2, 0, "\n");
          itemList.forEach((item, index) => {
            newarr.splice(item + index * 2 + 3, 0, "\n");
            newarr.splice(item + index * 2 + 4, 0, "[V: 2]");
          });
          break;
      }
      IfOContent = true
      backTextO.push(ContentValue)
      backTextOEnd.push(num)
      ContentValue = newarr.join("");
      oContent.value = ContentValue;
      ifAllOver = false;
      str = "";
    }
  };

  // V1
  const handleItemV = (
    num,
    type
  ) => {
    if (str || ifAllOver) {
      // 处理内容
      // if (IfOContent) {
      hisArr = ContentValue.split("");
      start = oContent.selectionStart,
        end = oContent.selectionEnd
      // } else {
      //   hisArr = ContentFiveValue.split("");
      //   start = fContent.selectionStart,
      //   end = fContent.selectionEnd
      // }
      let newarr;
      let itemList;
      let oldValue = "";
      let ifV1 = false;
      let ifV2 = false;
      // 获取下标
      if (ifAllOver) {
        start = 0;
      }
      itemList = [];
      newarr = hisArr.map((item, index) => {
        if (item === "\n" && hisArr[index + 1] === "\n") {
          itemList.push(index + 1);
        }
        if (item === " " && hisArr[index + 1] === " ") {
          return "";
        }
        if (
          item === "2" &&
          hisArr[index - 1] === " " &&
          hisArr[index - 2] === ":" &&
          hisArr[index - 4] === "[" &&
          hisArr[index - 3] === "V" &&
          hisArr[index + 1] === "]"
        ) {
          ifV2 = true;
        }
        if (
          item === "1" &&
          hisArr[index - 1] === " " &&
          hisArr[index - 2] === ":" &&
          hisArr[index - 4] === "[" &&
          hisArr[index - 3] === "V" &&
          hisArr[index + 1] === "]"
        ) {
          ifV1 = true;
        }
        return item;
      });
      let i = "";
      let j = [];
      if (type === "4V1") {
        for (i >= 0; i < num; i++) {
          j.push('"" z ');
        }
        j.push("|");
      }
      if (type === "8V1") {
        for (i >= 0; i < num / 3; i++) {
          j.push('"" z*3/2 ');
        }
        j.push("|");
      }
      i = j.join("");
      if (!ifV1) {
        newarr.splice(0, 0, "\n");
        newarr.splice(1, 0, "[V: 1]");
        newarr.splice(2, 0, "\n");
        newarr.splice(3, 0, i);
        if (ifV2 !== true) {
          newarr.splice(4, 0, "\n");
        } else {
          newarr.splice(4, 1, "\n");
        }
        itemList.forEach((item, index) => {
          if (ifV2 === true) {
            newarr.splice(item + index * 5 + 5, 0, "\n");
            newarr.splice(item + index * 5 + 6, 0, "[V: 1]");
            newarr.splice(item + index * 5 + 7, 0, "\n");
            newarr.splice(item + index * 5 + 8, 0, i);
            newarr.splice(item + index * 5 + 9, 0, "\n");
          } else {
            newarr.splice(item + index * 4 + 5, 0, "\n");
            newarr.splice(item + index * 4 + 6, 0, "[V: 1]");
            newarr.splice(item + index * 4 + 7, 0, "\n");
            newarr.splice(item + index * 4 + 8, 0, i);
          }
        });
        newarr = newarr.map((item, index) => {
          if (
            item === "\n" &&
            newarr[index + 1] === "\n" &&
            newarr[index - 1] === "\n"
          ) {
            return "";
          } else {
            return item;
          }
        });
      } else {
        let iL = [];
        let list = [];
        newarr.map((item, index) => {
          if (item === "\n") {
            ite = iL.join("");
            list.push(ite);
            iL = [];
          } else {
            iL.push(item);
          }
        });
        let strLine = newarr.join("");
        let newStr = strLine.replaceAll(list[2], i);
        newarr = [];
        for (let key in newStr) {
          newarr.push(newStr[key]);
        }
      }
      // if (IfOContent) {
      ContentValue = newarr.join("");
      oContent.value = ContentValue;
      backTextO.push(ContentValue)
      backTextOEnd.push(num)
      // } else {
      //   ContentFiveValue = newarr.join("");
      //   fContent.value = ContentFiveValue;
      //   backTextF.push(ContentFiveValue)
      //   backTextFEnd.push(num)
      // }
      ifAllOver = false;
      str = "";
    }
  };

  // 转一行,添加字符，排序
  const changeRightItem = (
    type,
    ite = ""
  ) => {
    if (str || ite.length > 0 || type === 5) {
      // 处理内容
      if (IfRContent) {
        hisArr = ContentRightValue.split("");
        start = rContent.selectionStart;
        sr = document.getElementById("content_right");
        end = rContent.selectionEnd;
      } else if (IfFiveContent && type === 5 && ite==='W:\t') {
        hisArr = ContentFiveValue.split("");
        start = fContent.selectionStart;
        sr = document.getElementById("content_five");
        end = fContent.selectionEnd;
      }
      let newar = [];
      let num1 = 0;
      let reg = /[\u4e00-\u9fa5]/;
      let reg1 = /[，。,.!?？！、]/;
      let reg2 = /[A-Za-z]/;
      let reg3 = /[\-\·]/;
      switch (type) {
        case 1:
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (item === "\n") {
                item = "";
              } else if (
                (item === " " || reg1.test(item)) &&
                (hisArr[index - 1] >= 0 || reg.test(hisArr[index - 1]))
              ) {
                item = "";
              } else {
                if (
                  ((item != " " &&
                    !reg3.test(item) &&
                    !reg2.test(hisArr[index - 1]) &&
                    !reg1.test(item)) ||
                    reg1.test(item)) &&
                  reg2.test(hisArr[index - 1])
                ) {
                  return "";
                }
                return item;
              }
            }
            return item;
          });
          break;
        case 3:
          let num = 0;
          let itemList = [];
          let strList = [];
          let item = [];
          if (IfRContent && str.length) {

            hisArr.map((i, index) => {
              if (i === "\n" || index === end - 1) {
                itemList.push(item);
                item = [];
              } else if (i === " " && hisArr[index + 1] === " ") {
                return;
              } else {
                item.push(i);
              }
            });

            itemList.forEach((it, ind) => {
              let str = it.join("");
              let list = str.split("|");
              strList.push(list);
            });
            let newList = [];

            strList.forEach((it) => {
              it.forEach((ele, ind) => {
                if (!newList[ind]) {
                  newList[ind] = [];
                }
                if (ele !== "") {
                  newList[ind].push(ele);
                }
              });
            });

            newarr = newList.map((i, ind) => {
              str1 = i.map((ele) => {
                return ele;
              });
              return str1 + "\n";
            });

            newarr = newarr.map((it, ind) => {
              let str = "";
              for (let i = 0; i < it.length; i++) {
                if (itemList.length > 1 && strList.length > 1) {
                  if (it[i] === ",") {
                    str += "\n";
                  } else {
                    if (
                      it[it.length - 1] === "\n" &&
                      i === it.length - 1 &&
                      ind === newarr.length - 2
                    ) {
                      it[it.length - 1] = "";
                    } else {
                      str += it[i];
                    }
                  }
                } else if (itemList.length === 1 && strList.length === 1) {
                  if (it[i] === "\n" && i !== it.length - 1) {
                    str += "\n\n";
                  } else if (
                    it[i] === "\n" &&
                    i === it.length - 1 &&
                    ind === newarr.length - 1
                  ) {
                    it[it.length - 1] = "";
                  } else {
                    str += it[i];
                  }
                }
              }

              if (
                ind === newarr.length - 2 &&
                itemList.length !== 1 &&
                strList.length !== 1
              ) {
                return str;
              } else if (itemList.length === 1 && strList.length === 1) {
                if (ind !== newarr.length - 1) {
                  return str + "\n";
                } else {
                  return str;
                }
              } else {
                return str + "\n";
              }
            });

            if (newarr[newarr.length - 1] === "\n\n") {
              newarr.pop();
            }
            let sortNewarr = newarr.length - 1;
            for (let i = newarr.length - 1; i >= 0; i--) {
              if (
                (newarr[newarr.length - 1] === "\n" ||
                  newarr[newarr.length - 1] === " ") &&
                (newarr[i] === "\n" || newarr[i] === " ") &&
                i === sortNewarr
              ) {
                sortNewarr--;
                newarr.pop();
              }
            }
          }
          break;
        case 4:
          let oldArr = [];
          if (IfRContent && str.length) {
            newarr = hisArr.map((item, index) => {
              if (
                item === "\n" &&
                hisArr[index + 1] !== "\n" &&
                index !== hisArr.length - 1
              ) {
                oldArr.push(index + 1);
              }
              if (item === " " && hisArr[index + 1] === " ") {
                return "";
              }
              return item;
            });
            newarr.splice(0, 0, "W: ");
            oldArr.forEach((item, index) => {
              newarr.splice(item + index * 3 + 1, 0, "W");
              newarr.splice(item + index * 3 + 2, 0, ":");
              newarr.splice(item + index * 3 + 3, 0, " ");
            });
          }
          break;
        case 5:
          let ifEnd = false;
          var sr = document.getElementById("content_right");
          num1++;
          newarr = hisArr.map((item, index) => {
            if (index === end - 1) {
              ifEnd = true;
            }
            return item;
          });
          if (str.length) {
            num1 = ite.length - str.length;
            newarr.splice(start, end - start, ite);
            num = end + num1
            setSelectionRange(sr, end + num1, end + num1);
          } else {
            if (end === 0) {
              // num = end + ite.length
              setSelectionRange(sr, end + ite.length, end + ite.length);
              newarr.splice(end, 0, ite);
            } else {
              if (ifEnd) {
                // num = end + ite.length
                setSelectionRange(sr, end + ite.length, end + ite.length);
                if (end === newarr.length) {
                  newarr.push(ite);
                } else {
                  newarr.splice(end, 0, ite);
                }
                ifEnd = false;
              }
            }
          }
          break;
      }


      if (type === 1) {
        newarr.splice(newarr.length, 0, "|");
        let sortNewarr = newarr.length - 1;
        for (let i = newarr.length - 1; i >= 0; i--) {
          if (
            (newarr[newarr.length - 1] === "\n" ||
              newarr[newarr.length - 1] === " ") &&
            (newarr[i] === "\n" || newarr[i] === " ") &&
            i === sortNewarr
          ) {
            sortNewarr--;
            newarr.pop();
          }
        }
      }


      if (IfRContent) {
        ContentRightValue = newarr.join("");
        rContent.value = ContentRightValue;
        backTextR.push(ContentRightValue)
        backTextREnd.push(num)
      } else if (IfFiveContent && type === 5 && ite==='W:\t'){
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }

      str = "";
    }
  };

  // 复位
  const returnBox = () => {
    oContent.style.height = "296px";
    rContent.style.height = "296px";
    oContent.style.width = "431.438px";
    rContent.style.width = "333.312px";
  };

  // 计算start起始
  const handleNum = (start, end, type, hisArr) => {
    let typeNum = 0;
    let reg1 = /[A-GZ0-9]/;
    for (let i = hisArr.length; i > 0; i--) {
      if (i >= start && i < end) {
        if (reg1.test(hisArr[i]) && hisArr[i] !== " ") {
          typeNum++;
          if (typeNum === type) {
            start = i;
            return start;
          }
        }
      }
    }
    while (typeNum !== type && start >= 0) {
      typeNum = 0;
      for (let i = hisArr.length; i >= 0; i--) {
        if (i >= start && i < end) {
          if (reg1.test(hisArr[i]) && hisArr[i] !== " ") {
            typeNum++;
            if (typeNum === type) {
              start = i;
            }
          }
        }
      }
      if (typeNum === type) {
        return start;
      } else if (typeNum > type) {
        start++;
      } else if (typeNum < type) {
        start--;
      }
    }
    return start;
  };

  // 处理特殊字符位置
  const handleSpecialCode = (specialCodeList, type, itemlist) => {
    let concat;
    let end = specialCodeList[specialCodeList.length - 1]
    let end2 = specialCodeList[0]
    let itend = itemlist[itemlist.length - 1]
    let itend2 = itemlist[itemlist.length - 2]
    let itend3 = itemlist[itemlist.length - 3]
    concat = specialCodeList.concat(itemlist)
    concat = concat.sort((a, b) => {
      return a - b;
    });
    let spliceList = []

    concat.map((item, index) => {
      if (concat[index + 1] - item === 1) {
        spliceList.push(item)
      }
    })

    spliceList.map((item) => {
      if (concat.indexOf(item) !== -1) {
        concat.splice(concat.indexOf(item), 1);
      }
    })
    return concat;
  };

  // 特殊字符
  const specialCode = (type, Code, addindex = 0, ifTrue = false) => {
    if (str || Code.length) {
      // 处理内容
      if (IfOContent) {
        hisArr = ContentValue.split("");
        start = oContent.selectionStart;
        sr = document.getElementById("content");
        end = oContent.selectionEnd;
      } else {
        hisArr = ContentFiveValue.split("");
        start = fContent.selectionStart;
        sr = document.getElementById("content_five");
        end = fContent.selectionEnd;
      }
      let newarr;
      let listCode;
      let reg = /[0-7A-GZ/<>',{} ]/;
      let reg1 = /[/<>]/;
      let reg2 = /[',{}]/;
      let ifjudgu = false;
      let itemlist = [];
      let specialCodeList = [];
      let judgulist = [];
      let isNull = false;
      let isSpecialCode = false;
      let isSpecialCode1 = false;
      let num1 = 0;
      let specialNum = 0;
      let concat;
      listCode = Code.split(" ");
      hisArr.map((item, index) => {
        if (index < end) {
          if (item === "," || item === "'" || item === "{" || item === "}") {
            specialNum++;
          }
        }
      });
      if ((type === 3 || type === 2 || type === 4) && !str.length) {
        // 计算start起始点
        start = end - addindex - specialNum;
        start = handleNum(start, end, type, hisArr);
        if (start < 0) {
          start = 0;
        }
      } else if (type === 8 && !str.length) {
        start = handleNum(start, end, 1, hisArr);
      } else if (type === 12 && !str.length) {
        start = handleNum(start, end, 1, hisArr);
      }
      newarr = hisArr.map((item, index) => {
        if (index >= start && index < end) {
          itemlist.push(index);
          judgulist.push(reg.test(item));
          if (reg1.test(item) || reg2.test(item)) {
            num1++;
          }
          if (item === " " && !str.length) {
            num1++;
            isNull = true;
          } else if (item === " " && str.length) {
            num1++;
            isNull = false;
          }
        }
        return item;
      });
      ifjudgu = judgulist.every((item) => item === true);
      if (
        !ifjudgu &&
        type !== 8 &&
        type !== 9 &&
        type !== 10 &&
        type !== 12
      ) {
        alert("您选中的值不属于0-7,A-G,Z中之一!");
      } else {
        if (
          num1 > 0 &&
          (type === 3 ||
            type === 2 ||
            type === 4 ||
            type === 5 ||
            type === 6 ||
            type === 7)
        ) {
          itemlist = [];
          judgulist = [];
          newarr = hisArr.map((item, index) => {
            if (index >= start && index < end) {
              if (reg1.test(item)) {
                isSpecialCode1 = true;
                return "";
              } else if (reg2.test(item)) {
                isSpecialCode = true;
                specialCodeList.push(index);
                return item;
              } else if (item === " " && !str.length) {
                isNull = true;
              } else if (item === " " && !isNull && str.length) {
                return "";
              } else {
                itemlist.push(index);
                judgulist.push(reg.test(item));
              }
            }
            if (item === " " && hisArr[index + 1] === " ") {
              return "";
            }
            return item;
          });
        }
        switch (type) {
          case 1:
            if (end - start > 2) {
              return alert("数字数量不对，点击无效");
            } else {
              newarr.splice(end, 0, listCode[0]);
              newarr.splice(end + 1, 0, listCode[1]);
              newarr.splice(end + 2, 0, listCode[2]);
              newarr.splice(end + 3, 0, listCode[3]);
              newarr.length + 4;
              num = end + 1
              setSelectionRange(sr, end + 1, end + 1);
            }
            break;
          case 2:
            if ((str.length && type + num1 !== end - start) || isNull) {
              return alert("数字数量不对，点击无效");
            } else {
              if (listCode.length > 3) {
                if (listCode.length === 4 && listCode[1] !== "/") {
                  if (isSpecialCode && specialCodeList.length > 2) {
                    newarr.splice(specialCodeList[1] + 1, 0, " ");
                    newarr.splice(specialCodeList[1] + 2, 0, listCode[1]);
                    newarr.splice(specialCodeList[1] + 3, 0, " ");
                  } else if (isSpecialCode && specialCodeList.length == 2) {
                    newarr.splice(specialCodeList[0] + 1, 0, " ");
                    newarr.splice(specialCodeList[0] + 2, 0, listCode[1]);
                    newarr.splice(specialCodeList[0] + 3, 0, " ");
                  } else {
                    newarr.splice(itemlist[0] + 1, 0, " ");
                    newarr.splice(itemlist[0] + 2, 0, listCode[1]);
                    newarr.splice(itemlist[0] + 3, 0, " ");
                  }
                }
                end += 3;
              } else {
                concat = handleSpecialCode(specialCodeList, type, itemlist);
                for (let i = 0; i < 2; i++) {
                  if (isSpecialCode) {
                    // 带特殊符号
                    if (specialCodeList.length === 4) {
                      newarr.splice(
                        specialCodeList[i + 1] + 1 + 2 * i,
                        0,
                        listCode[i + 1]
                      );
                    } else {
                      newarr.splice(
                        concat[i] + 1 + 1 * i,
                        0,
                        listCode[i + 1]
                      );
                    }
                  } else {
                    newarr.splice(
                      itemlist[i] + 1 + 1 * i,
                      0,
                      listCode[i + 1]
                    );
                  }
                  end++;
                }
              }
            }
            str.length = 0;
            if(newarr[end] !== ' '){
              newarr.splice(end, 0, " ");
            }

            if (listCode.length > 3) {
              num = start + Code.length + 2 + specialCodeList.length
              setSelectionRange(sr,num,num);
            } else {
              num = start + Code.length + 1 + specialCodeList.length
              setSelectionRange(sr,num,num);
            }
            end += 1;
            break;
          case 3:
            if ((str.length && type + num1 !== end - start) || isNull) {
              return alert("数字数量不对，点击无效");
            } else {
              concat = handleSpecialCode(specialCodeList, type, itemlist);
              if (listCode.length === 4) {
                for (let i = 0; i < 3; i++) {
                  if (isSpecialCode) {
                    newarr.splice(concat[i] + 1 + 1 * i, 0, listCode[i + 1])
                  } else {
                    newarr.splice(
                      itemlist[i] + 1 + 1 * i,
                      0,
                      listCode[i + 1]
                    );
                  }
                  end++;
                }
              } else if (listCode.length === 1) {
                newarr.splice(itemlist[0], 0, listCode[0]);
                if (isSpecialCode) {
                  for (let index = 0; index < 3; index++) {
                    newarr.splice(
                      concat[index] + 2 + 1 * index,
                      0,
                      "/"
                    );
                    end++;
                  }
                } else {
                  for (let index = 0; index < itemlist.length; index++) {
                    newarr.splice(itemlist[index] + 2 + 1 * index, 0, "/");
                    end++;
                  }
                }
                end++;
              } else {
                if (isSpecialCode) {
                  concat = handleSpecialCode(specialCodeList, type, itemlist);
                  if (specialCodeList.length > 3) {
                    if (listCode[0] === "(三") {
                      newarr.splice(itemlist[0], 0, listCode[0]);
                      for (let index = 0; index < 2; index++) {
                        newarr.splice(
                          concat[index] + 2 + 1 * index,
                          0,
                          " "
                        );
                      }
                      end--;
                    } else {
                      newarr.splice(concat[0] + 2, 0, listCode[1]);
                      newarr.splice(concat[0] + 3, 0, " ");
                      newarr.splice(concat[1] + 3, 0, " ");
                      newarr.splice(concat[2] + 4, 0, listCode[5]);
                    }
                  } else {
                    if (listCode[0] === "(三") {
                      newarr.splice(itemlist[0], 0, listCode[0]);
                      for (let index = 0; index < 2; index++) {
                        newarr.splice(
                          concat[index] + 2 + 1 * index,
                          0,
                          " "
                        );
                      }
                      end--;
                    } else {
                      newarr.splice(concat[0] + 1, 0, listCode[1]);
                      newarr.splice(concat[0] + 2, 0, " ");
                      newarr.splice(concat[1] + 3, 0, " ");
                      newarr.splice(concat[2] + 4, 0, listCode[5]);
                    }
                  }
                } else {
                  if (isSpecialCode1) {
                    newarr.splice(itemlist[0] + 1, 0, listCode[1]);
                    newarr.splice(itemlist[0] + 2, 0, " ");
                    newarr.splice(itemlist[1] + 3, 0, " ");
                    newarr.splice(itemlist[2] + 4, 0, listCode[5]);
                  } else {
                    if (listCode.length === 5) {
                      newarr.splice(itemlist[0], 0, listCode[0]);
                    } else {
                      newarr.splice(itemlist[0] + 1, 0, listCode[1]);
                    }
                    newarr.splice(itemlist[0] + 2, 0, " ");
                    newarr.splice(itemlist[1] + 3, 0, " ");
                    newarr.splice(itemlist[2] + 4, 0, listCode[5]);
                  }
                }
                end += 4;
              }
            }
            if(newarr[end] !== ' '){
              newarr.splice(end, 0, " ");
            }
            if (listCode[0] === "(三" && listCode.length > 1) {
              num = start + Code.length + 2 + specialCodeList.length
              setSelectionRange(
                sr,
                start + Code.length + 2 + specialCodeList.length,
                start + Code.length + 2 + specialCodeList.length
              );
            } else if (listCode[0] === "(三" && listCode.length === 1) {
              num = start + 9 + specialCodeList.length
              setSelectionRange(
                sr,
                start + 9 + specialCodeList.length,
                start + 9 + specialCodeList.length
              );
            } else {
              num = start + Code.length + 1 + specialCodeList.length
              setSelectionRange(
                sr,
                start + Code.length + 1 + specialCodeList.length,
                start + Code.length + 1 + specialCodeList.length
              );
            }
            end += 1;
            str.length = 0;
            break;
          case 4:
            if ((str.length && type + num1 !== end - start) || isNull) {
              return alert("数字数量不对，点击无效");
            } else {
              for (let i = 0; i < 4; i++) {
                if (isSpecialCode) {
                  concat = handleSpecialCode(specialCodeList, type, itemlist);
                  newarr.splice(concat[i] + 1 + 1 * i, 0, listCode[i + 1]);
                } else {
                  newarr.splice(itemlist[i] + 1 + 1 * i, 0, listCode[1]);
                }
                end++;
              }
            }
            str.length = 0;
            if(newarr[end] !== ' '){
              newarr.splice(end, 0, " ");
            }
            num = start + Code.length + 1 + specialCodeList.length
            setSelectionRange(
              sr,
              start + Code.length + 1 + specialCodeList.length,
              start + Code.length + 1 + specialCodeList.length
            );
            end += 1;
            break;
          case 5:
            // console.log(type,num1,end,start);
            if (type + num1 !== end - start) {
              return alert("数字数量不对，点击无效");
            } else {
              newarr.splice(itemlist[0], 0, listCode[0]);
              concat = handleSpecialCode(specialCodeList, type, itemlist);
              if (specialCodeList.length > 5) {
                for (let index = 0; index < 5; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === specialCodeList.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 28
                setSelectionRange(sr, start + 28, start + 28);
              } else if (isSpecialCode) {
                for (let index = 0; index < 5; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === concat.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 23
                setSelectionRange(sr, start + 23, start + 23);
              } else {
                for (let index = 0; index < itemlist.length; index++) {
                  newarr.splice(itemlist[index] + 2 + 1 * index, 0, "//");
                  if (index === itemlist.length - 1) {
                    let i = itemlist[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 18
                setSelectionRange(sr, start + 18, start + 18);
              }
            }
            break;
          case 6:
            if (type + num1 !== end - start) {
              return alert("数字数量不对，点击无效");
            } else {
              concat = handleSpecialCode(specialCodeList, type, itemlist);

              newarr.splice(itemlist[0], 0, listCode[0]);
              if (specialCodeList.length > 6) {
                for (let index = 0; index < 6; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === concat.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 33
                setSelectionRange(sr, start + 33, start + 33);
              } else if (isSpecialCode) {
                for (let index = 0; index < 6; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === concat.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 27
                setSelectionRange(sr, start + 27, start + 27);
              } else {
                for (let index = 0; index < itemlist.length; index++) {
                  newarr.splice(itemlist[index] + 2 + 1 * index, 0, "//");
                  if (index === itemlist.length - 1) {
                    let i = itemlist[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 21
                setSelectionRange(sr, start + 21, start + 21);
              }
            }
            break;
          case 7:
            if (type + num1 !== end - start) {
              return alert("数字数量不对，点击无效");
            } else {
              concat = handleSpecialCode(specialCodeList, type, itemlist);

              newarr.splice(itemlist[0], 0, listCode[0]);
              if (specialCodeList.length > 7) {
                for (let index = 0; index < 7; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === concat.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 38
                setSelectionRange(sr, start + 38, start + 38);
              } else if (isSpecialCode) {
                for (let index = 0; index < 7; index++) {
                  newarr.splice(
                    concat[index] + 2 + 1 * index,
                    0,
                    "//"
                  );
                  if (index === concat.length - 1) {
                    let i = concat[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 31
                setSelectionRange(sr, start + 31, start + 31);
              } else {
                for (let index = 0; index < itemlist.length; index++) {
                  newarr.splice(itemlist[index] + 2 + 1 * index, 0, "//");
                  if (index === itemlist.length - 1) {
                    let i = itemlist[index] + 3 + 1 * index;
                    if(newarr[i] !== ' '){
                      newarr.splice(i, 0, " ");
                    }
                  }
                }
                num = start + 24
                setSelectionRange(sr, start + 24, start + 24);
              }
            }
            break;
          case 8:
            if (itemlist.length === 2 && str.length) {
              for (let index = 0; index < itemlist.length - 1; index++) {
                newarr.splice(
                  itemlist[index] + 1 + 1 * index,
                  0,
                  listCode[0]
                );
              }
            } else {
              newarr.splice(itemlist[itemlist.length - 1] + 1, 0, "-");
            }
            num = end + 1
            setSelectionRange(oContent, end + 1, end + 1);
            break;
          case 12:
            let sum = -1;
            if (itemlist.length > 1 && str.length) {
              for (let index = 0; index < itemlist.length - 1; index++) {
                sum += 3;
                newarr.splice(itemlist[index] + 1 + 1 * index, 0, " - ");
              }
            } else {
              newarr.splice(itemlist[itemlist.length - 1] + 1, 0, " - ");
            }
            newarr = newarr.join("").split("");
            let enterNum = 0;
            let ifAfter = false;
            newarr = newarr.map((item, index) => {
              if (
                end === index &&
                newarr[end - 1] !== " " &&
                newarr[end] === " "
              ) {
                ifAfter = true;
              }
              if (item === " " && newarr[index + 1] === " ") {
                enterNum++;
                return "";
              }
              return item;
            });
            if (ifAfter) {
              enterNum = 0;
            }
            if (itemlist.length > 1 && str.length) {
              num = end + sum - enterNum
              setSelectionRange(
                oContent,
                end + sum - enterNum,
                end + sum - enterNum
              );
            } else {
              num = end + 3 - enterNum
              setSelectionRange(
                oContent,
                end + 3 - enterNum,
                end + 3 - enterNum
              );
            }
            break;
          case 9:
            newarr.splice(end, 0, " ");
            newarr.splice(end + 1, 0, "-");
            newarr.splice(end + 2, 0, " ");
            newarr.splice(end + 3, 0, "|");
            newarr.splice(end + 4, 0, "\n");
            newarr.splice(end + 5, 0, "\n");
            newarr = newarr.join("").split("");
            let enNum = 0;
            let ifAf = false;
            newarr = newarr.map((item, index) => {
              if (
                end === index &&
                newarr[end - 1] !== " " &&
                newarr[end] === " "
              ) {
                ifAf = true;
              }
              if (item === " " && newarr[index + 1] === " ") {
                enNum++;
                return "";
              }
              if (ifAf) {
                if (item === " " && newarr[index - 1] === " ") {
                  enNum++;
                  return "";
                }
              }
              return item;
            });
            if (ifAf) {
              enNum = 0;
            }
            num = end + 5 - enNum
            setSelectionRange(oContent, end + 5 - enNum, end + 5 - enNum);
            if(newarr[end+6] === ' '){
              newarr.splice(end+6,1)
            }
            break;
          case 10:
            newarr.splice(itemlist[0], 0, "(");
            newarr.splice(end + 1, 0, ")");
            // newarr.splice(end + 2, 0, " ");
            break;
          case 11:
            num = end + Code.length
            newarr.splice(end, 0, Code);
            setSelectionRange(sr, end + Code.length, end + Code.length);
            break;
          case 0:
            let ifEnter = false;
            num1++;
            newarr = hisArr.map((item, index) => {
              if (index === end - 1 || index === end) {
                ifEnter = true;
              }
              return item;
            });
            if (ifEnter) {
              if (ifTrue) {
                if (
                  (newarr[end - 1] === "," || newarr[end - 1] === "'") &&
                  newarr[end - 1] !== Code[0]
                ) {
                  switch (Code[0]) {
                    case ",":
                      newarr.splice(end, 0, "'");
                      break;
                    case "'":
                      newarr.splice(end, 0, ",");
                      break;
                  }
                } else {
                  newarr.splice(end, 0, Code[0]);
                  if(newarr[end+1] !== ' '){
                    newarr.splice(end + 1, 0, Code[1]);
                  }
                }
              } else {
                newarr.splice(end, 0, Code[0]);
                if(newarr[end+1] !== ' '){
                    newarr.splice(end + 1, 0, Code[1]);
                  }
              }
            }
            ifEnter = false;
            num = end + num1 + 1
            setSelectionRange(sr, end + num1 + 1, end + num1 + 1);
            break;
        }
      }
      if (IfOContent) {
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
      } else {
        backTextF.push(ContentFiveValue)
        backTextFEnd.push(num)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }
      ifAllOver = false;
      ifTrue = false;
      isNull = false;
      isSpecialCode = false;
      isSpecialCode1 = false;
      str = "";
      num1 = 0;
    }
  };
  // 点击添加
  const clickaddspecialCode = (
    type,
    Code,
    start = fContent.selectionStart,
    end = fContent.selectionEnd
  ) => {
    if (str || Code.length) {
      // 处理内容
      hisArr = ContentFiveValue.split("");
      let newarr;
      let ifFirstEnter = false;
      let enterlist = [];

      newarr = hisArr.map((item, index) => {
        if (index >= start && index < end) {
          if (hisArr[index - 1] === "\n" && item !== "I") {
            ifFirstEnter = true;
          } else if (
            item === "\n" &&
            hisArr[index - 1] !== "\n" &&
            index + 1 !== hisArr.length - 1 &&
            hisArr[index + 1] !== Code
          ) {
            enterlist.push(index);
          }
        }
        return item;
      });
      switch (Code) {
        case "I":
          newarr.splice(start, 0, "\nI: ");
          break;
        case "T":
          newarr.splice(start, 0, "T: ");
          for (let index = 0; index < enterlist.length; index++) {
            newarr.splice(enterlist[index] + 2 + 1 * index, 0, "T: ");
          }
          break;
        case "C":
          newarr.splice(start, 0, "C: ");
          for (let index = 0; index < enterlist.length; index++) {
            newarr.splice(enterlist[index] + 2 + 1 * index, 0, "C: ");
          }
          break;
        case "QMLK":
          let itemcode = Code.split("");
          if (str.length) {
            if (str.length === 3) {
              enterlist.push(end - 2);
            }
            if (enterlist.length > 1) {
              newarr.splice(start, 0, `${itemcode[0]}: `);
              for (let index = 0; index < itemcode.length - 1; index++) {
                newarr.splice(
                  enterlist[index] + 1 * index + 2,
                  0,
                  `${itemcode[index + 1]}: `
                );
              }
            } else {
              for (let index = 0; index < itemcode.length; index++) {
                newarr.splice(
                  end + 1 * index + 1,
                  0,
                  `${itemcode[index]}: \n`
                );
              }
            }
          } else {
            for (let index = 0; index < itemcode.length; index++) {
              newarr.splice(end + 1 * index + 1, 0, `${itemcode[index]}: \n`);
            }
          }
          break;
        case "V":
          newarr.splice(
            end + 1,
            0,
            "V:1 style=tab clef=standardtab ins=24 vol=100 bracket=2 \n"
          );
          newarr.splice(end + 2, 0, "V:2 style=jianpu ins=l vol=100 \n");
          newarr.splice(end + 3, 0, "% V:3 style=jianpu ins=1 vo1=100 \n");
          newarr.splice(end + 4, 0, "% V:4 style=jianpu ins=1 vo1=100 \n");
          newarr.length + 4;
          break;
      }
      backTextF.push(ContentFiveValue)
      ContentFiveValue = newarr.join("");
      fContent.value = ContentFiveValue;
      str = "";
    }
  };
  //并音词
  const merge = () => {
    let ContentValue2 = document.getElementById("content").value; //左边
    let ContentRightValue2 = document.getElementById("content_right").value; //右边
    let ContentFiveValue2 = document.getElementById("content_five").value; //最后

    let filterW = []
    let ifTrue = false
    ContentValue2 = ContentValue2.split("").map((item, index) => {
      if (item === " " && ContentValue2[index + 1] === " ") {
        return "";
      } else {
        return item;
      }
    });
    ContentRightValue2 = ContentRightValue2.split("").map((item, index) => {
      if (item === " " && ContentRightValue2[index + 1] === " ") {
        return "";
      } else {
        return item;
      }
    });

    ContentValue2 = ContentValue2.join("").replace(/\n\n/g, "@");
    ContentRightValue2 = ContentRightValue2.join("").replace(/\n\n/g, "@");

    let contentarr = ContentValue2.split("@"); //左边数组
    let contentRightarr = ContentRightValue2.split("@"); //右边数组
    let newArr = [];

    //去除首个换行
    contentarr.forEach((item, index) => {
      if (item.indexOf("\n") === 0) {
        contentarr[index] = contentarr[index].replace(/\n/, "");
      }
      if (
        item.lastIndexOf("\n") === item.length - 1 &&
        index === contentarr.length - 1
      ) {
        contentarr[index] = contentarr[index].slice(0, item.length - 1);
      }
    });
    contentRightarr.forEach((item, index) => {
      filterW.push(contentRightarr[index][0]==='W'&&contentRightarr[index][1]===':');
      if (item.indexOf("\n") === 0) {
        contentRightarr[index] = contentRightarr[index].replace(/\n/, "");
      }
    });
    ifTrue = filterW.every((item)=>item===true)
    if (
      contentarr.length > contentRightarr.length ||
      contentarr.length < contentRightarr.length
    ) {
      alert("左右表单内容组数量不对等，禁止合并！");
    } else if (ifTrue === false) {
      alert("未添加词前W，禁止合并！");
    } else if (contentarr.length == contentRightarr.length && ifTrue !== false) {
      //合并
      for (let index = 0; index < contentarr.length; index++) {
        if (contentarr[index] !== "") {
          newArr.push("");
          newArr.push(contentarr[index]);
          newArr.push("\n");
          newArr.push(contentRightarr[index]);
          newArr.push("\n");
        }
      }
    }
    // else {
    //   for (let index = 0; index < contentRightarr.length; index++) {
    //     if (contentRightarr[index] !== "") {
    //       newArr.push("");
    //       newArr.push(contentarr[index]);
    //       newArr.push("\n");
    //       newArr.push(contentRightarr[index]);
    //       newArr.push("\n");
    //     }
    //   }
    // }

    newArr.forEach((item, index) => {
      if (item == "") {
        newArr[index] = "\r\n";
      }
    });

    //向最终填词
    //判断是否原有值
    if (ContentFiveValue2 == "") {
      fContent.value = newArr.join("");
      ContentFiveValue = newArr.join("");
    } else {
      fContent.value = ContentFiveValue2 + newArr.join("");
      ContentFiveValue = fContent;
    }
  };
  //冒号左
  const zhijiefuzhi = (val) => {
    if (str || val.length || ifAllOver) {
      // 处理内容
      var sr;
      if (IfOContent) {
        hisArr = ContentValue.split("");
        sr = document.getElementById("content");
        start = oContent.selectionStart;
        end = oContent.selectionEnd;
      } else if (IfRContent) {
        hisArr = ContentRightValue.split("");
        sr = document.getElementById("content_right");
        start = rContent.selectionStart;
        end = rContent.selectionEnd;
      } else {
        hisArr = ContentFiveValue.split("");
        sr = document.getElementById("content_five");
        start = fContent.selectionStart;
        end = fContent.selectionEnd;
      }
      let ifEnter = false;
      let newarr;
      let num1 = val.length;
      newarr = hisArr.map((item, index) => {
        if (
          index === end ||
          (index + 1 === hisArr.length && hisArr[index] !== val)
        ) {
          ifEnter = true;
        }
        return item;
      });
      if (hisArr.length > 0) {
        if (str.length) {
          num1 = val.length - str.length;
          newarr.splice(start, end - start, val);
        } else {
          if (ifEnter) {
            newarr.splice(end, 0, val);
          }
          ifEnter = false;
        }
      } else {
        newarr.push(val);
      }
      num = end + num1
      setSelectionRange(sr, end + num1, end + num1);

      if (IfOContent) {
        ContentValue = newarr.join("");
        oContent.value = ContentValue;
        backTextO.push(ContentValue)
        backTextOEnd.push(num)
      } else if (IfRContent) {
        backTextREnd.push(num)
        backTextR.push(ContentRightValue)
        ContentRightValue = newarr.join("");
        rContent.value = ContentRightValue;
      } else {
        backTextFEnd.push(num)
        backTextF.push(ContentFiveValue)
        ContentFiveValue = newarr.join("");
        fContent.value = ContentFiveValue;
      }


      num1 = 0;
      ifAllOver = false;
      str = "";
    }
  };

  oContent.onfocus = () => {
    //检测text变动
    const config = {
      attributes: true,
      childList: false,
      subtree: true,
      attributeFilter: ["style"],
      attributeOldValue: true,
    };
    const observer = new MutationObserver((mutationsList, observer) => {
      width = getComputedStyle(oContent).getPropertyValue("width");
      width = width.split("px")[0];
      rContent.style.width = 772 - width + "px";
    });
    //开始观测
    observer.observe(oContent, config);
  };

  rContent.onfocus = () => {
    const config = {
      attributes: true,
      childList: false,
      subtree: true,
      attributeFilter: ["style"],
      attributeOldValue: true,
    };
    const observerRight = new MutationObserver((mutationsList, observer) => {
      width = getComputedStyle(rContent).getPropertyValue("width");
      width = width.split("px")[0];
      oContent.style.width = 772 - width + "px";
    });
    observerRight.observe(rContent, config);
  };

  // 赋值添加内容
  const zhuanhuanfuzhi = (type, len) => {
    // 处理内容
    if (IfOContent) {
      hisArr = ContentValue.split("");
      sr = document.getElementById("content");
      start = oContent.selectionStart;
      end = oContent.selectionEnd;
    } else {
      hisArr = ContentFiveValue.split("");
      sr = document.getElementById("content_five");
      start = fContent.selectionStart;
      end = fContent.selectionEnd;
    }
    let newarr;
    newarr = hisArr.map((item, index) => {
      return item;
    });
    switch (type) {
      case 1:
        if (!str.length) {
          newarr.splice(end, 0, ' "1."|0');
        } else {
          newarr.splice(start, end - start, ' "1."|0');
        }
        break;
      case 2:
        if (!str.length) {
          newarr.splice(end, 0, ' "2.3.4.":|0');
        } else {
          newarr.splice(start, end - start, ' "2.3.4.":|0');
        }
        break;
    }
    if (!str.length) {
      num = end + len
      setSelectionRange(sr, end + len, end + len);
    } else {
      num = start + len
      setSelectionRange(sr, start + len, start + len);
    }

    if (IfOContent) {
      backTextO.push(ContentValue)
      backTextOEnd.push(num)
      ContentValue = newarr.join("");
      oContent.value = ContentValue;
    } else {
      backTextF.push(ContentFiveValue)
      backTextFEnd.push(num)
      ContentFiveValue = newarr.join("");
      fContent.value = ContentFiveValue;
    }
    str = "";
  };

  // 进行five模块排序
  const overSort = (type) => {
    // 处理内容
    hisArr = ContentFiveValue.split("");
    start = fContent.selectionStart;
    end = fContent.selectionEnd;
    let newarr = [];
    let enterSplit = []; //分割列表
    let specialSplit = []; //]分割列表
    let indlist = []; //用于收集符合判断的下标
    let itelist = []; //用于收集符合判断的内容
    // 处理每个模块，进行切割
    hisArr.map((item, index) => {
      if (
        item === "\n" &&
        hisArr[index - 1] === "]" &&
        hisArr[index - 2] >= 0 &&
        hisArr[index - 5] === "V" &&
        (hisArr[index + 1] === '"' || hisArr[index + 1] === "\n" || (hisArr[index + 1] === "|" &&  hisArr[index + 2] === ":"))
      ) {
        enterSplit.push(index);
        if (hisArr[index + 1] === "\n") {
          return hisArr.splice(index + 1, 1);
        }
      }
      if (
        item >= 0 &&
        hisArr[index - 1] === "%" &&
        hisArr[index - 3] === "]" &&
        hisArr[index - 7] === "V" &&
        hisArr[index - 8] === "["
      ) {
        enterSplit.push(index - 2);
        hisArr.splice(index - 2, 3);
      }
      return item;
    });
    let i = -1;
    // 利用下标进行添加内容
    newarr = hisArr.map((item, index) => {
      if (enterSplit.includes(index)) {
        i += 1;
        if (hisArr[index + 1] === "\n") {
          return " %" + (i + +type);
        } else {
          return " %" + (i + +type) + "\n";
        }
      } else {
        if (
          item === "\n" &&
          hisArr[index - 1] === "\n" &&
          hisArr[index - 2] >= 0 &&
          hisArr[index - 3] === "]" &&
          hisArr[index - 4] >= 0 &&
          hisArr[index - 6] === ":" &&
          hisArr[index - 7] === "V"
        ) {
          // console.log(hisArr[index-1],hisArr[index-2],hisArr[index-3],hisArr[index-4],hisArr[index-5],hisArr[index-6],item);
          return "";
        } else if (
          item === "\n" &&
          hisArr[index - 1] === "\n" &&
          hisArr[index - 2] === "\n" &&
          hisArr[index - 3] >= 0 &&
          hisArr[index - 4] === "]" &&
          hisArr[index - 5] >= 0 &&
          hisArr[index - 7] === ":" &&
          hisArr[index - 8] === "V"
        ) {
          return "";
        } else if (
          item === "\n" &&
          hisArr[index - 1] === "\n" &&
          hisArr[index - 2] === "\n" &&
          hisArr[index - 3] === "\n" &&
          hisArr[index - 4] >= 0 &&
          hisArr[index - 5] === "]" &&
          hisArr[index - 6] >= 0 &&
          hisArr[index - 8] === ":" &&
          hisArr[index - 9] === "V"
        ) {
          return "";
        } else if (
          item === "\n" &&
          hisArr[index - 1] === "\n" &&
          hisArr[index - 2] === "\n" &&
          hisArr[index - 3] === "\n" &&
          hisArr[index - 4] === "\n" &&
          hisArr[index - 5] >= 0 &&
          hisArr[index - 6] === "]" &&
          hisArr[index - 7] >= 0 &&
          hisArr[index - 9] === ":" &&
          hisArr[index - 10] === "V"
        ) {
          return "";
        } else {
          return item;
        }
      }
    });
    backTextF.push(ContentFiveValue)
    ContentFiveValue = newarr.join("");
    fContent.value = ContentFiveValue;
    str = "";
  };

  // 打开遮罩层
  const clickMask = (type, id) => {
    const mask = document.getElementById(id);
    const broList = document.getElementsByClassName("mask");
    for (let index = 0; index < broList.length; index++) {
      broList[index].style.display = "none";
    }
    if (type) {
      mask.style.width = getComputedStyle(fContent).getPropertyValue("width");
      mask.style.height =
        getComputedStyle(fContent).getPropertyValue("height");
      mask.style.display = "block";
    } else {
      mask.style.display = "none";
    }
  };

  // 添加固定文本
  const addtext = (type) => {
    // 处理内容
    hisArr = ContentFiveValue.split("");
    start = fContent.selectionStart;
    end = fContent.selectionEnd;
    let newarr;
    let spliceIndex = 0;
    // 判断为什么版本获取下标切割
    hisArr.map((item, index) => {
      if (
        item === "谱" &&
        hisArr[index - 1] === "线" &&
        hisArr[index - 2] === "空" &&
        hisArr[index - 3] === " " &&
        hisArr[index - 4] === "%"
      ) {
        if (hisArr[index + 2] === "\n" && hisArr[index + 3] === "\n") {
          spliceIndex = index + 4;
        } else {
          spliceIndex = index + 3;
        }
      } else if (
        item === "版" &&
        hisArr[index - 1] === "翻" &&
        hisArr[index - 2] === "免" &&
        hisArr[index - 3] === " " &&
        hisArr[index - 4] === "%"
      ) {
        spliceIndex = index + 3;
      } else if (
        item === "版" &&
        hisArr[index - 1] === "页" &&
        hisArr[index - 2] === "翻" &&
        hisArr[index - 3] === " " &&
        hisArr[index - 4] === "%"
      ) {
        spliceIndex = index + 3;
      } else {
        return item;
      }
    });
    switch (type) {
      case 1:
        //添加空线版
        newarr = ContentFiveValue.split("");
        newarr.splice(
          0,
          spliceIndex,
          `%MUSE2
%%barsperstaff 4\t% (【每行小节数】控制每行小节数的数量，须为整数********
%%scale 0.56\t\t% (【伸缩控制】乐谱左右方向的伸缩控制）********
%%continueall yes\t% (【换行控制】是否忽略脚本的换行控制，yes或no）
%%sysstaffsep 0.78cm\t% (【音轨间距】控制各音轨之间的间距）********
%%systemsep 2.60cm\t% (【乐谱间距】控制每行乐谱之间的间距，非音轨之间的间距）********
%%gchordspace 0.30cm\t% (【和弦与谱线间距】和弦与谱线之间的距离）
%%tab_btextspace 0.20cm\t% (【下注释文字间距】谱线下的注释文字与线之间的间距）
%%tabstemheight 0.13cm\t% (【符杆长度】符杆的长度控制）
%%tabstringsep 0.30cm\t% (【线与线距】六线谱的每条线之间的间距）

%%pagewidth 18.60cm\t% (【页面总宽度】即乐谱纸张的宽度）
%%pageheight 27.00cm\t% (【页面总高度】即乐谱纸张的高度）
%%topmargin 0.30cm\t% (【页面上边距】上边距，即曲谱上边空白区域控制）
%%rightmargin 0.20cm\t% (【页面左边距】左边距，即曲谱左边空白区域控制）
%%botmargin 0.00cm\t% (【页面下边距】下边距，曲谱页面底部空白区域控制）
%%leftmargin 0.20cm\t% (【页面左边距】左边距，即曲谱左边空白区域控制）
%%staffwidth 18.20cm\t% (【乐谱宽度】相当于控制右边距，即曲谱宽度或右边空白区域控制）

%%titlespace -0.35cm\t% (【主标题（歌名）上下占位】歌名垂直占位，即歌名和顶边的距离）
%%composerspace  0.00cm\t% (【作者区域上占位】作词、作曲、原唱、制谱的距离占位）
%%vocalspace 0.92cm\t% (【歌词上下占位】歌词垂直占位，即歌词和音符的距离）
%%musicspace\t-0.20cm % (【速度调式拍号I配置上下占位】
%%showpagenumber no\t% (【是否显示页码】页码显示，yes显示，no为不显示）

%%showfinger yes\t% (【和弦图指法】是否显示和弦图手指信息，yes显示数字指法，no为小黑点）
%%showcheck yes\t% (【和弦图空弦和禁弹】和弦图上是否显示空弦和禁止弹记号，yes显示，no为不显示）
%%showpattern yes\t% (【和弦名显示】和弦显示和弦图，还是只显示和弦名字，yes显示方格和弦图，no为仅显示和弦名）
%%showname yes\t% (【和弦图样式】和弦图上是否显示和弦的名字，yes显示，no只显示方格和弦图）
%%chordgridwidth 6.00pt\t% (【和弦图小格宽度】）
%%chordgridheight 8.00pt % (【和弦图小格高度】）

% 【设置谱面字体及大小】参数定义（从左到右）：字体 字体大小(17.10为五号字) 是否加粗(400为正常800为粗) 是否斜体(1是斜体0为不斜) 是否下划线(1是有0为无) 字符集(123为GB2312 字符集))
%% titlefont "OPPOSans M" 26.00 400 0 0 134\t% 主标题字体样式
%% subtitlefont "思源黑体 CN Regular" 18.00 400 0 0 134\t% 副标题字体样式
%% composerfont "文泉驿等宽正黑" 12.00 400 0 0 134\t% 作词、作曲、原唱、制谱及注释说明（I的配置项）的字体样式
%% tempofont "文泉驿等宽正黑" 16.00 400 0 0 134\t% 速度、调式、拍号的字体样式
%% textfont "思源黑体 CN Regular" 16.00 400 0 0 134\t% 线谱上方注释的字体样式
%% vocalfont "OPPOSans M" 21.00 400 0 0 134\t% 歌词的字体样式
%% tabfont "思源黑体 CN Regular" 18 400 0 0 134\t% 六线谱线上符号x或扫弦的字体或大小样式
%% jianpufont "Roboto" 20 400 0 0 134\t\t% 简谱旋律（数字）样式
%% gchordfont "OPPOSans B" 16 400 0 0 134\t% 和弦名称与指法数字字体样式
%% barnumberfont "思源黑体 CN Regular" 12.00 400 0 0 134\t% 小节号其他设置
%% barlabelfont "思源黑体 CN Regular" 12.00 200 0 0 134\t% 小节号字体及大小

%% barnumbers 1 \t% (【是否显示小节号，-1 表示不显示小节号，1表示从1开始连续显示小节号，2表示从2开始间隔两个小节显示小节号，依次类推】）

% 【以下为和弦图个性化指法设置】
%%gchord C=1;0,3,2,0,1,0
%%gchord D/#F=1;2,X,0,2(1),3(3),2(2)
%%gchord Fmaj7=1;0,0,3,2,1,0
%%gchord Am7=1;0,0,2,0,1,0
%%gchord Am7/E=1;0,0,2,0,1,0
%%gchord Em/B=1;0,2,2,0,0,0
%%gchord Bm=2;1(1),1(1),3(3),3(4),2(2),1(1)
%%gchord Bm7=2;1(1),1(1),3(3),1(1),2(2),1(1)
%%gchord B=2;1(1),1(1),3(2),3(3),3(4),1(1)
%%gchord bB=1;1(1),1(1),3(2),3(3),3(4),1(1)

% 空线谱版
\n`
        );
        break;
      case 2:
        //添加免翻版
        newarr = ContentFiveValue.split("");
        newarr.splice(
          0,
          spliceIndex,
          `%MUSE2
%%barsperstaff\t% (【每行小节数】控制每行小节数的数量，须为整数********
%%scale 0.65\t\t% (【伸缩控制】乐谱左右方向的伸缩控制）********
%%topmargin 1.20cm\t% (【页面上边距】上边距，即曲谱上边空白区域控制）********
%%botmargin 1.20cm\t% (【页面下边距】下边距，曲谱页面底部空白区域控制）********
%%continueall 1\t% (【换行控制】是否忽略脚本的换行控制，yes或no 或者 1或0 ）
%%sysstaffsep 0.78cm\t% (【音轨间距】控制各音轨之间的间距）
%%systemsep 2.60cm\t% (【乐谱间距】控制每行乐谱之间的间距，非音轨之间的间距）
%%gchordspace 0.40cm\t% (【和弦与谱线间距】和弦与谱线之间的距离）
%%tab_btextspace 0.20cm\t% (【下注释文字间距】谱线下的注释文字与线之间的间距）
%%tabstemheight 0.13cm\t% (【符杆长度】符杆的长度控制）
%%tabstringsep 0.30cm\t% (【线与线距】六线谱的每条线之间的间距）

%%pagewidth 21.00cm\t% (【页面总宽度】即乐谱纸张的宽度）
%%pageheight 29.70cm\t% (【页面总高度】即乐谱纸张的高度）
%%leftmargin 1.50cm\t% (【页面右边距】左边距，即曲谱右边空白区域控制）
%%rightmargin 1.50cm\t% (【页面右边距】右边距，即曲谱右边空白区域控制）
%%staffwidth 18.00cm\t% (【乐谱宽度】相当于控制右边距，即曲谱宽度或右边空白区域控制）

%%titlespace -0.35cm\t% (【主标题（歌名）上下占位】歌名垂直占位，即歌名和顶边的距离）
%%composerspace  0.00cm\t% (【作者区域上占位】作词、作曲、原唱、制谱的距离占位）
%%vocalspace 0.92cm\t% (【歌词上下占位】歌词垂直占位，即歌词和音符的距离）
%%musicspace\t-0.20cm % (【速度调式拍号I配置上下占位】
%%showpagenumber yes\t% (【是否显示页码】页码显示，yes显示，no为不显示）

%%showfinger yes\t% (【和弦图指法】是否显示和弦图手指信息，yes显示数字指法，no为小黑点）
%%showcheck yes\t% (【和弦图空弦和禁弹】和弦图上是否显示空弦和禁止弹记号，yes显示，no为不显示）
%%showpattern yes\t% (【和弦名显示】和弦显示和弦图，还是只显示和弦名字，yes显示方格和弦图，no为仅显示和弦名）
%%showname yes\t\t% (【和弦图样式】和弦图上是否显示和弦的名字，yes显示，no只显示方格和弦图）
%%chordgridwidth 6.00pt\t% (【和弦图小格宽度】）
%%chordgridheight 8.00pt % (【和弦图小格高度】）

% 【设置谱面字体及大小】参数定义（从左到右）：字体 字体大小(17.10为五号字) 是否加粗(400为正常800为粗) 是否斜体(1是斜体0为不斜) 是否下划线(1是有0为无) 字符集(123为GB2312 字符集))
%% titlefont "OPPOSans M" 28.00 400 0 0 134\t% 主标题字体样式
%% subtitlefont "思源黑体 CN Regular" 20.00 400 0 0 134\t% 副标题字体样式
%% composerfont "文泉驿等宽正黑" 14.00 400 0 0 134\t% 作词、作曲、原唱、制谱及注释说明（I的配置项）的字体样式
%% tempofont "文泉驿等宽正黑" 16.00 400 0 0 134\t% 速度、调式、拍号的字体样式
%% textfont "思源黑体 CN Regular" 16.00 400 0 0 134\t% 线谱上方注释的字体样式
%% vocalfont "OPPOSans M" 21.00 400 0 0 134\t% 歌词的字体样式
%% tabfont "思源黑体 CN Regular" 18 400 0 0 134\t% 六线谱线上符号x或扫弦的字体或大小样式
%% jianpufont "Roboto" 20 400 0 0 134\t\t% 简谱旋律（数字）样式
%% gchordfont "OPPOSans B" 16 400 0 0 134\t% 和弦名称与指法数字字体样式
%% barnumberfont "思源黑体 CN Regular" 12.00 400 0 0 134\t% 小节号其他设置
%% barlabelfont "思源黑体 CN Regular" 12.00 200 0 0 134\t% 小节号字体及大小

%% barnumbers 1\t% (【是否显示小节号，-1 表示不显示小节号，1表示从1开始连续显示小节号，2表示从2开始间隔两个小节显示小节号，依次类推】）

% 【以下为和弦图个性化指法设置】
%%gchord C=1;0,3,2,0,1,0
%%gchord D/#F=1;2,X,0,2(1),3(3),2(2)
%%gchord Fmaj7=1;0,0,3,2,1,0
%%gchord Am7=1;0,0,2,0,1,0
%%gchord Am7/E=1;0,0,2,0,1,0
%%gchord Em/B=1;0,2,2,0,0,0
%%gchord Bm=2;1(1),1(1),3(3),3(4),2(2),1(1)
%%gchord Bm7=2;1(1),1(1),3(3),1(1),2(2),1(1)
%%gchord B=2;1(1),1(1),3(2),3(3),3(4),1(1)
%%gchord bB=1;1(1),1(1),3(2),3(3),3(4),1(1)
    
% 免翻版
\n`
        );
        break;
      case 3:
        //添加翻页版
        newarr = ContentFiveValue.split("");
        newarr.splice(
          0,
          spliceIndex,
          `%MUSE2
%%barsperstaff\t4\t% (【每行小节数】控制每行小节数的数量，须为整数********
%%scale 0.70\t\t% (【伸缩控制】乐谱左右方向的伸缩控制）********
%%topmargin 1.20cm\t% (【页面上边距】上边距，即曲谱上边空白区域控制）********
%%botmargin 1.20cm\t% (【页面下边距】下边距，曲谱页面底部空白区域控制）********
%%continueall 1\t% (【换行控制】是否忽略脚本的换行控制，yes或no 或者 1或0 ）
%%sysstaffsep 0.95cm\t% (【音轨间距】控制各音轨之间的间距）
%%systemsep 2.80cm\t% (【乐谱间距】控制每行乐谱之间的间距，非音轨之间的间距）
%%gchordspace 0.40cm\t% (【和弦与谱线间距】和弦与谱线之间的距离）
%%tab_btextspace 0.20cm\t% (【下注释文字间距】谱线下的注释文字与线之间的间距）
%%tabstemheight 0.13cm\t% (【符杆长度】符杆的长度控制）
%%tabstringsep 0.30cm\t% (【线与线距】六线谱的每条线之间的间距）

%%pagewidth 21.00cm\t% (【页面总宽度】即乐谱纸张的宽度）
%%pageheight 29.70cm\t% (【页面总高度】即乐谱纸张的高度）
%%leftmargin 1.50cm\t% (【页面右边距】左边距，即曲谱右边空白区域控制）
%%rightmargin 1.50cm\t% (【页面右边距】右边距，即曲谱右边空白区域控制）
%%staffwidth 18.00cm\t% (【乐谱宽度】相当于控制右边距，即曲谱宽度或右边空白区域控制）

%%titlespace -0.35cm\t% (【主标题（歌名）上下占位】歌名垂直占位，即歌名和顶边的距离）
%%composerspace 0.00cm\t% (【作者区域上占位】作词、作曲、原唱、制谱的距离占位）
%%vocalspace 0.92cm\t% (【歌词上下占位】歌词垂直占位，即歌词和音符的距离）
%%musicspace\t-0.20cm % (【速度调式拍号I配置上下占位】
%%showpagenumber yes\t% (【是否显示页码】页码显示，yes显示，no为不显示）

%%showfinger yes\t% (【和弦图指法】是否显示和弦图手指信息，yes显示数字指法，no为小黑点）
%%showcheck yes\t% (【和弦图空弦和禁弹】和弦图上是否显示空弦和禁止弹记号，yes显示，no为不显示）
%%showpattern yes\t% (【和弦名显示】和弦显示和弦图，还是只显示和弦名字，yes显示方格和弦图，no为仅显示和弦名）
%%showname yes\t% (【和弦图样式】和弦图上是否显示和弦的名字，yes显示，no只显示方格和弦图）
%%chordgridwidth 6.00pt\t% (【和弦图小格宽度】）
%%chordgridheight 8.00pt\t% (【和弦图小格高度】）

% 【设置谱面字体及大小】参数定义（从左到右）：字体 字体大小(17.10为五号字) 是否加粗(400为正常800为粗) 是否斜体(1是斜体0为不斜) 是否下划线(1是有0为无) 字符集(123为GB2312 字符集))
%% titlefont "OPPOSans M" 28.00 400 0 0 134\t% 主标题字体样式
%% subtitlefont "思源黑体 CN Regular" 20.00 400 0 0 134\t% 副标题字体样式
%% composerfont "文泉驿等宽正黑" 14.00 400 0 0 134\t% 作词、作曲、原唱、制谱及注释说明（I的配置项）的字体样式
%% tempofont "文泉驿等宽正黑" 16.00 400 0 0 134\t% 速度、调式、拍号的字体样式
%% textfont "思源黑体 CN Regular" 16.00 400 0 0 134\t% 线谱上方注释的字体样式
%% vocalfont "OPPOSans M" 21.00 400 0 0 134\t% 歌词的字体样式
%% tabfont "思源黑体 CN Regular" 18 400 0 0 134\t% 六线谱线上符号x或扫弦的字体或大小样式
%% jianpufont "Roboto" 20 400 0 0 134\t% 简谱旋律（数字）样式
%% gchordfont "OPPOSans B" 16 400 0 0 134\t% 和弦名称与指法数字字体样式
%% barnumberfont "思源黑体 CN Regular" 12.00 400 0 0 134\t% 小节号其他设置
%% barlabelfont "思源黑体 CN Regular" 12.00 200 0 0 134\t% 小节号字体及大小

%% barnumbers 1\t% (【是否显示小节号，-1 表示不显示小节号，1表示从1开始连续显示小节号，2表示从2开始间隔两个小节显示小节号，依次类推】）

% 【以下为和弦图个性化指法设置】
%%gchord C=1;0,3,2,0,1,0
%%gchord D/#F=1;2,X,0,2(1),3(3),2(2)
%%gchord Fmaj7=1;0,0,3,2,1,0
%%gchord Am7=1;0,0,2,0,1,0
%%gchord Am7/E=1;0,0,2,0,1,0
%%gchord Em/B=1;0,2,2,0,0,0
%%gchord Bm=2;1(1),1(1),3(3),3(4),2(2),1(1)
%%gchord Bm7=2;1(1),1(1),3(3),1(1),2(2),1(1)
%%gchord B=2;1(1),1(1),3(2),3(3),3(4),1(1)
%%gchord bB=1;1(1),1(1),3(2),3(3),3(4),1(1)

% 翻页版
\n`
        );
        break;
      case 4:
        //添加谱头
        newarr = hisArr;
        newarr.splice(
          end,
          0,
          `I:
%I: 选用C调指法编配，Capo:0-4品(男声调C-E)，5-7品(女声调F-G)
%I: 选用C调指法编配，Capo:4-5品(女声调E-F)，0品(男声调C)
%I: 选用C调指法编配，Capo:4-5品(男声调B-C)
%I: 选用C调指法编配，Capo:0-2品(女声调G-A)

T: XXX
T: [初级弹唱 简易版]

C: [原唱：XXX   ]
C: [作词：XXX   ]
C: [作曲：XXX   ]
C: [制谱：二  少]

Q: 1/4=00
M: 4/4
L: 1/4
K: C

V:1 style=tab clef=standardtab ins=24 vol=100 bracket=2
V:2 style=jianpu ins=1 vol=100
% V:3 style=jianpu ins=1 vol=100
\n`
        );
        break;
    }
    let sortNewarr = newarr.length - 1;
    // 删除末尾多余空格以及换行
    for (let i = newarr.length - 1; i >= 0; i--) {
      if (
        (newarr[newarr.length - 1] === "\n" ||
          newarr[newarr.length - 1] === " " ||
          newarr[newarr.length - 1] === "") &&
        (newarr[i] === "\n" || newarr[i] === " " || newarr[i] === "") &&
        i === sortNewarr
      ) {
        sortNewarr--;
        newarr.pop();
      }
    }
    ContentFiveValue = newarr.join("");
    backTextF.push(ContentFiveValue)
    fContent.value = ContentFiveValue;
    str = "";
  };

</script>

</html>